import{i as p,Z as f,bc as b,c as r,o as i,b as t,t as a,d as x,F as g,f as _,a as h,w as v,e as w,r as y,p as k}from"./app-BJSEvLr2.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={name:"SubscriptionPayment",components:{Head:f,Link:p},props:{subscription:{type:Object,required:!0},payment:{type:Object,required:!0},moyasarConfig:{type:Object,required:!0}},setup(o){const e=y(!0),s=y(null),l=()=>new Promise((n,c)=>{if(window.Moyasar){n();return}const d=document.createElement("link");d.rel="stylesheet",d.href="https://unpkg.com/moyasar-payment-form@2.0.16/dist/moyasar.css",document.head.appendChild(d);const m=document.createElement("script");m.src="https://unpkg.com/moyasar-payment-form@2.0.16/dist/moyasar.umd.js",m.onload=n,m.onerror=c,document.head.appendChild(m)}),u=async()=>{try{await l(),window.Moyasar.init({element:"#moyasar-form",amount:o.moyasarConfig.amount,currency:o.moyasarConfig.currency,description:o.moyasarConfig.description,publishable_api_key:o.moyasarConfig.publishable_api_key,callback_url:o.moyasarConfig.callback_url,methods:["creditcard"],on_completed:async function(n){try{await fetch(route("client.payment.completed"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({payment_id:n.id,local_payment_id:o.payment.id})})}catch(c){console.error("Error saving payment ID:",c)}}}),e.value=!1}catch(n){console.error("Error loading Moyasar:",n),s.value="فشل في تحميل نموذج الدفع. يرجى إعادة تحميل الصفحة.",e.value=!1}};return k(()=>{u()}),{isLoading:e,error:s}}},j={class:"min-h-screen bg-gray-50 py-8"},M={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},S={class:"text-center mb-8"},E={class:"text-gray-600"},N={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},O={class:"bg-white rounded-lg shadow-md p-6"},B={class:"space-y-4"},q={class:"flex justify-between items-center"},F={class:"font-medium"},P={class:"flex justify-between items-center"},T={class:"font-medium"},V={class:"flex justify-between items-center"},z={class:"font-medium"},D={key:0,class:"space-y-2"},I={class:"list-disc list-inside space-y-1"},A={class:"flex justify-between items-center text-lg font-bold"},H={class:"text-blue-600"},J={class:"bg-white rounded-lg shadow-md p-6"},K={key:0,class:"text-center py-8"},R={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4 mb-4"},X={class:"flex"},Z={class:"mr-3"},G={class:"mt-1 text-sm text-red-700"},Q={key:2},U={class:"text-center mt-8"};function W(o,e,s,l,u,n){const c=b("Link");return i(),r("div",j,[t("div",M,[t("div",S,[e[0]||(e[0]=t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," إتمام الاشتراك ",-1)),t("p",E," أكمل عملية الدفع لتفعيل اشتراكك في "+a(s.subscription.name),1)]),t("div",N,[t("div",O,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," تفاصيل الاشتراك ",-1)),t("div",B,[t("div",q,[e[1]||(e[1]=t("span",{class:"text-gray-600"},"اسم الخطة:",-1)),t("span",F,a(s.subscription.name),1)]),t("div",P,[e[2]||(e[2]=t("span",{class:"text-gray-600"},"المدة:",-1)),t("span",T,a(s.subscription.duration_days)+" يوم",1)]),t("div",V,[e[3]||(e[3]=t("span",{class:"text-gray-600"},"الوصف:",-1)),t("span",z,a(s.subscription.description),1)]),s.subscription.features&&s.subscription.features.length?(i(),r("div",D,[e[4]||(e[4]=t("span",{class:"text-gray-600"},"المميزات:",-1)),t("ul",I,[(i(!0),r(g,null,_(s.subscription.features,d=>(i(),r("li",{key:d,class:"text-sm text-gray-700"},a(d),1))),128))])])):x("",!0),e[6]||(e[6]=t("hr",{class:"my-4"},null,-1)),t("div",A,[e[5]||(e[5]=t("span",null,"المبلغ الإجمالي:",-1)),t("span",H,a(s.subscription.price)+" ريال سعودي",1)])])]),t("div",J,[e[12]||(e[12]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," معلومات الدفع ",-1)),l.isLoading?(i(),r("div",K,e[8]||(e[8]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),t("p",{class:"mt-4 text-gray-600"},"جاري تحضير نموذج الدفع...",-1)]))):l.error?(i(),r("div",R,[t("div",X,[e[10]||(e[10]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),t("div",Z,[e[9]||(e[9]=t("h3",{class:"text-sm font-medium text-red-800"},"خطأ في تحضير الدفع",-1)),t("p",G,a(l.error),1)])])])):(i(),r("div",Q,e[11]||(e[11]=[t("div",{id:"moyasar-form",class:"mb-4"},null,-1),t("div",{class:"text-sm text-gray-500 text-center"},[t("p",null,"الدفع آمن ومحمي بواسطة Moyasar"),t("p",{class:"mt-1"},"نحن لا نحتفظ بمعلومات بطاقتك الائتمانية")],-1)])))])]),t("div",U,[h(c,{href:o.route("client.subscriptions.index"),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:v(()=>e[13]||(e[13]=[t("svg",{class:"ml-2 -mr-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),w(" العودة إلى الاشتراكات ")])),_:1,__:[13]},8,["href"])])])])}const tt=C(L,[["render",W],["__scopeId","data-v-f281728a"]]);export{tt as default};
