import{r as g,m as J,p as Je,c as b,o as x,a as L,b as l,w as oe,u as ne,Z as Ke,d as I,t as A,F as K,f as V,n as j,i as qe,q as Z,h as ie,s as Ye,e as Xe,g as Ve}from"./app-BJSEvLr2.js";import{E as Ze,L as Ge,P as Qe,a as et,D as tt}from"./DesignElement-afgWAcdT.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";const st={class:"min-h-screen bg-gray-100",dir:"rtl"},lt={class:"bg-white shadow-sm border-b border-gray-200"},ot={class:"max-w-full mx-auto px-6 py-4"},nt={class:"flex justify-between items-center"},it={class:"flex items-center space-x-4 space-x-reverse"},rt={class:"text-sm text-gray-600"},ct={class:"text-xs text-gray-500"},dt={class:"flex items-center space-x-3 space-x-reverse"},ut={class:"flex items-center bg-gray-100 rounded-lg p-1"},pt=["disabled"],gt=["disabled"],ft={class:"flex items-center bg-gray-100 rounded-lg p-1"},vt=["onClick","title"],ht=["disabled"],yt={class:"flex h-screen"},mt={class:"w-80 bg-white border-l border-gray-200 flex flex-col"},xt={class:"flex-shrink-0 border-b border-gray-200"},wt={class:"flex"},bt=["onClick"],kt={class:"flex-1 overflow-hidden"},$t={key:0,class:"h-full"},Ct={key:1,class:"h-full"},_t={key:2,class:"h-full"},St={class:"flex-1 bg-gray-50 flex flex-col"},Mt={class:"flex-shrink-0 bg-white border-b border-gray-200 p-4"},It={class:"flex items-center justify-between"},zt={class:"flex items-center space-x-4 space-x-reverse"},Tt={class:"flex items-center space-x-2 space-x-reverse"},Et={class:"text-sm text-gray-600 min-w-16 text-center"},Pt={class:"flex-1 overflow-auto p-8 flex items-center justify-center"},Dt={key:0,class:"absolute pointer-events-none select-none",style:{bottom:"15px",right:"15px",fontSize:"14px",color:"rgba(0, 0, 0, 0.25)",fontFamily:"Cairo, sans-serif",fontWeight:"bold",textShadow:"1px 1px 2px rgba(255, 255, 255, 0.8)",zIndex:9999,transform:"rotate(-15deg)",transformOrigin:"center",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",letterSpacing:"1px"}},Lt={class:"bg-white rounded-lg shadow-xl max-w-6xl max-h-[90vh] w-full mx-4"},At={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40"},jt={class:"bg-white rounded-lg p-8 flex items-center space-x-4 space-x-reverse"},Bt={class:"text-lg font-medium"},Rt={key:2,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},Ot={__name:"Show",props:{clientTemplate:{type:Object,required:!0}},setup(q){const C=q,z=g("elements"),O=g("desktop"),y=g(1),re=g(!1);g(!1);const f=g(800),v=g(600),B=g(!1),ce=g(!1),de=g(""),G=g(!1),Q=g(null),k=g(""),E=g("contain"),T=g(!0),P=g(null),R=g(!1),D=g(null),r=g([]),u=g(null),_=g([]),$=g(-1),ue=g(null),N=g(null),pe=[{id:"elements",name:"العناصر",icon:"fas fa-shapes"},{id:"layers",name:"الطبقات",icon:"fas fa-layer-group"},{id:"properties",name:"الخصائص",icon:"fas fa-cog"}],ge=[{id:"desktop",name:"سطح المكتب",icon:"fas fa-desktop"},{id:"tablet",name:"تابلت",icon:"fas fa-tablet-alt"},{id:"mobile",name:"موبايل",icon:"fas fa-mobile-alt"}],ee=J(()=>$.value>0),te=J(()=>$.value<_.value.length-1),fe=J(()=>r.value.map((e,s)=>({id:e.id,name:e.name||`عنصر ${s+1}`,type:e.type,visible:e.visible!==!1,locked:e.locked||!1}))),ve=J(()=>{const e=20*y.value;return{backgroundImage:`
            linear-gradient(to right, #e5e7eb 1px, transparent 1px),
            linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)
        `,backgroundSize:`${e}px ${e}px`}}),he=e=>{switch(O.value=e,e){case"desktop":f.value=1200,v.value=800;break;case"tablet":f.value=768,v.value=1024;break;case"mobile":f.value=375,v.value=667;break}},ye=()=>{y.value=Math.min(y.value+.1,3)},me=()=>{y.value=Math.max(y.value-.1,.1)},xe=e=>{if(e.type==="image"){const s={id:F(),type:e.type,name:e.name,x:f.value/2-100,y:v.value/2-100,width:e.width||200,height:e.height||100,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:r.value.length,...e.properties};r.value.push(s),u.value=s,m()}else P.value=e},we=e=>{u.value={...e,properties:e.properties?{...e.properties}:void 0},z.value="properties"},be=e=>{const s=r.value.find(o=>o.id===e);s&&(u.value={...s,properties:s.properties?{...s.properties}:void 0},z.value="properties")},ke=(e,s)=>{const o=r.value.findIndex(t=>t.id===e);o!==-1&&(r.value[o]={...r.value[o],...s},m())},Y=e=>{var o;const s=r.value.findIndex(t=>t.id===e);s!==-1&&(r.value.splice(s,1),((o=u.value)==null?void 0:o.id)===e&&(u.value=null),m())},$e=e=>{const s=e.map(o=>r.value.find(t=>t.id===o)).filter(Boolean);r.value=s,W(),m()},Ce=e=>{if(P.value){const s=N.value.getBoundingClientRect(),o=(e.clientX-s.left)/y.value,t=(e.clientY-s.top)/y.value,a=P.value,c={id:F(),type:a.type,name:a.name,x:o,y:t,width:a.width||200,height:a.height||100,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:r.value.length,...a.properties};r.value.push(c),u.value=c,m(),P.value=null}else e.target===N.value&&(u.value=null)},_e=e=>{e.preventDefault(),Array.from(e.dataTransfer.files).forEach(o=>{if(o.type.startsWith("image/")){const t=new FileReader;t.onload=a=>{const c={id:F(),type:"image",name:o.name,x:e.offsetX,y:e.offsetY,width:300,height:200,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:r.value.length,src:a.target.result};r.value.push(c),u.value=c,m()},t.readAsDataURL(o)}})},m=()=>{_.value=_.value.slice(0,$.value+1),_.value.push(JSON.parse(JSON.stringify(r.value))),$.value++,_.value.length>50&&(_.value.shift(),$.value--)},ae=()=>{ee.value&&($.value--,r.value=JSON.parse(JSON.stringify(_.value[$.value])),u.value=null)},X=()=>{te.value&&($.value++,r.value=JSON.parse(JSON.stringify(_.value[$.value])),u.value=null)},F=()=>"element_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),Se=(e,s=800,o=.7)=>new Promise(t=>{if(!e.startsWith("data:image/")){t(e);return}const a=new Image;a.onload=()=>{const c=document.createElement("canvas"),h=c.getContext("2d");let{width:i,height:n}=a;const d=e.length;d>1e6?(s=600,o=.5):d>5e5&&(s=700,o=.6),(i>s||n>s)&&(i>n?(n=n*s/i,i=s):(i=i*s/n,n=s)),c.width=i,c.height=n,h.drawImage(a,0,0,i,n);const p=c.toDataURL("image/jpeg",o);console.log(`Image compressed: ${Math.round(d/1024)}KB -> ${Math.round(p.length/1024)}KB`),t(p)},a.src=e}),se=async()=>{var e,s;B.value=!0;try{if(!((e=C.clientTemplate)!=null&&e.id))throw new Error("Client Template ID is missing");const o=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content;if(!o)throw new Error("CSRF token not found");console.log("Compressing images...");const t=await Promise.all((r.value||[]).map(async n=>{if(n.type==="image"&&n.src&&n.src.startsWith("data:image/")){const d=await Se(n.src);return{...n,src:d}}return n}));console.log("Image compression complete");const a={elements:t,canvas:{width:f.value||800,height:v.value||600,background:k.value||"",backgroundSize:E.value||"contain"},settings:{device:O.value||"desktop",zoom:y.value||1},watermark:{text:"سامقة للتصميم",enabled:!0,position:"bottom-right",style:{fontSize:"14px",color:"rgba(0, 0, 0, 0.25)",fontFamily:"Cairo, sans-serif",fontWeight:"bold",rotation:"-15deg"}}};let c;try{c=JSON.stringify(a);const n=new Blob([c]).size;if(n>16777215)throw new Error(`بيانات التصميم كبيرة جداً (${Math.round(n/1024/1024)}MB). يرجى تقليل حجم الصور.`)}catch(n){throw new Error("Invalid design data: "+n.message)}console.log("Saving design data:",a),console.log("Client Template ID:",C.clientTemplate.id),console.log("Data size:",Math.round(new Blob([c]).size/1024),"KB");const h={design_data:c,canvas_size:`${f.value}x${v.value}`,design_notes:`تم التحديث في ${new Date().toLocaleString("ar-SA")}`};console.log("Request payload size:",Math.round(new Blob([JSON.stringify(h)]).size/1024),"KB");const i=await fetch(route("admin.client-templates.update",C.clientTemplate.id),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o},body:JSON.stringify(h)});if(i.ok){const n=await i.json();console.log("Design saved successfully",n),n.success&&alert("تم حفظ التصميم بنجاح")}else{let n="Failed to save design";try{const d=await i.json();n=d.message||n,console.error("Server error details:",d)}catch(d){console.error("Could not parse error response:",d)}throw console.error("HTTP Status:",i.status,i.statusText),new Error(n)}}catch(o){console.error("Error saving design:",o);let t="خطأ في حفظ التصميم";o.message&&(t+=": "+o.message),alert(t)}finally{B.value=!1}},Me=()=>{const e={elements:r.value,canvas:{width:f.value,height:v.value}};console.log("Preview data:",e),window.open("","_blank").document.write(Ie(e))},Ie=e=>{let s=`
        <!DOCTYPE html>
        <html dir="rtl">
        <head>
            <meta charset="UTF-8">
            <title>معاينة التصميم</title>
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
                @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');
                body {
                    margin: 0;
                    padding: 20px;
                    font-family: 'Cairo', sans-serif;
                    background: #f5f5f5;
                }
                .canvas {
                    width: ${e.canvas.width}px;
                    height: ${e.canvas.height}px;
                    position: relative;
                    background: white;
                    border: 1px solid #ddd;
                    margin: 0 auto;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                    ${k.value?`
                        background-image: url(${k.value});
                        background-size: ${E.value};
                        background-position: center;
                        background-repeat: no-repeat;
                    `:""}
                }
                .element { position: absolute; }
                h2 { text-align: center; color: #333; margin-bottom: 20px; }
                .footer {
                    text-align: center;
                    margin-top: 20px;
                    color: #666;
                    font-size: 12px;
                }
            </style>
        </head>
        <body>
            <h2>معاينة التصميم - سامقة</h2>
            <div class="canvas">
    `;return e.elements.forEach(o=>{o.visible!==!1&&(s+=ze(o))}),s+=`
                <!-- Always show watermark in preview -->
                <div style="
                    position: absolute;
                    bottom: 15px;
                    right: 15px;
                    font-size: 14px;
                    color: rgba(0, 0, 0, 0.25);
                    font-family: 'Cairo', sans-serif;
                    font-weight: bold;
                    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
                    z-index: 9999;
                    transform: rotate(-15deg);
                    transform-origin: center;
                    user-select: none;
                    letter-spacing: 1px;
                    pointer-events: none;
                ">سامقة للتصميم</div>
            </div>
            <div class="footer">
                <p>© ${new Date().getFullYear()} سامقة للتصميم - جميع الحقوق محفوظة</p>
                <p>تم إنشاء هذا التصميم باستخدام منصة سامقة للتصميم</p>
            </div>
        </body>
        </html>
    `,s},ze=e=>{const s=`
        left: ${e.x}px;
        top: ${e.y}px;
        width: ${e.width}px;
        height: ${e.height}px;
        transform: rotate(${e.rotation}deg);
        opacity: ${e.opacity};
        z-index: ${e.zIndex};
    `;switch(e.type){case"text":return`<div class="element" style="${s} font-size: ${e.fontSize||16}px; color: ${e.color||"#000"}; font-weight: ${e.fontWeight||"normal"}; text-align: ${e.textAlign||"left"}; font-family: ${e.fontFamily||"Cairo, sans-serif"}; display: flex; align-items: center; justify-content: center;">${e.text||"نص"}</div>`;case"image":return`<img class="element" src="${e.src}" style="${s} object-fit: cover;" alt="${e.name}">`;case"rectangle":return`<div class="element" style="${s} background-color: ${e.backgroundColor||"#000"}; border-radius: ${e.borderRadius||0}px;"></div>`;case"circle":return`<div class="element" style="${s} background-color: ${e.backgroundColor||"#000"}; border-radius: 50%;"></div>`;case"triangle":return`<div class="element" style="${s} background-color: transparent; position: relative;">
                <svg width="${e.width||100}" height="${e.height||100}" style="position: absolute; top: 0; left: 0;">
                    <polygon points="${(e.width||100)/2},0 0,${e.height||100} ${e.width||100},${e.height||100}"
                             fill="${e.backgroundColor||"#000"}" />
                </svg>
            </div>`;case"star":const o=Math.min(e.width||100,e.height||100),t=o/2,a=t/2,c=o/2,h=o/2;let i="";const n=5,d=Math.PI/n;let p=Math.PI/2*3;i+=`M ${c} ${h-t} `;for(let w=0;w<n;w++){const S=c+Math.cos(p)*t,M=h+Math.sin(p)*t;i+=`L ${S} ${M} `,p+=d;const U=c+Math.cos(p)*a,H=h+Math.sin(p)*a;i+=`L ${U} ${H} `,p+=d}return i+="Z",`<div class="element" style="${s} background-color: transparent; position: relative;">
                <svg width="${o}" height="${o}" style="position: absolute; top: 0; left: 0;">
                    <path d="${i}" fill="${e.backgroundColor||"#000"}" />
                </svg>
            </div>`;case"icon":return`<div class="element" style="${s} color: ${e.color||"#000"}; display: flex; align-items: center; justify-content: center; font-size: ${e.fontSize||24}px; font-family: 'Font Awesome 6 Free', sans-serif;">${e.icon||"★"}</div>`;case"line":return`<div class="element" style="${s} background-color: ${e.backgroundColor||e.color||"#6b7280"}; border-radius: ${e.borderRadius||0}px;"></div>`;default:return""}},Te=()=>{if(C.clientTemplate.design_data)try{let e;if(typeof C.clientTemplate.design_data=="string")e=JSON.parse(C.clientTemplate.design_data);else if(typeof C.clientTemplate.design_data=="object")e=C.clientTemplate.design_data;else throw new Error("Invalid design data format");r.value=e.elements||[],e.canvas&&(f.value=e.canvas.width||800,v.value=e.canvas.height||600,k.value=e.canvas.background||"",E.value=e.canvas.backgroundSize||"contain"),e.settings&&(O.value=e.settings.device||"desktop",y.value=e.settings.zoom||1),m()}catch(e){console.error("Error loading design:",e),r.value=[],m()}else m()},le=()=>{G.value=!1,Q.value=null},Ee=e=>{console.log("Photo edited:",e),le()};function Pe(e){k.value=e}function De(e){const s={id:Date.now(),type:"image",src:e,x:f.value/2-100,y:v.value/2-100,width:200,height:200,name:"صورة"};r.value.push(s),u.value=s}const Le=async()=>{try{const e=T.value;if(T.value=!0,await Ye(),!N.value)return;const o=document.createElement("canvas"),t=o.getContext("2d");o.width=f.value,o.height=v.value,t.fillStyle="#ffffff",t.fillRect(0,0,f.value,v.value),k.value&&await new Promise(a=>{const c=new Image;c.crossOrigin="anonymous",c.onload=()=>{if(E.value==="contain"){const h=f.value/v.value,i=c.width/c.height;let n,d,p,w;i>h?(n=f.value,d=f.value/i,p=0,w=(v.value-d)/2):(n=v.value*i,d=v.value,p=(f.value-n)/2,w=0),t.drawImage(c,p,w,n,d)}else if(E.value==="cover"){const h=f.value/v.value,i=c.width/c.height;let n,d,p,w;i>h?(d=v.value,n=v.value*i,p=(f.value-n)/2,w=0):(n=f.value,d=f.value/i,p=0,w=(v.value-d)/2),t.drawImage(c,p,w,n,d)}else t.drawImage(c,0,0,f.value,v.value);a()},c.onerror=()=>a(),c.src=k.value});for(const a of r.value)if(a.visible!==!1)switch(a.type){case"text":t.save(),t.font=`${a.fontWeight||"normal"} ${a.fontSize||16}px ${a.fontFamily||"Cairo, sans-serif"}`,t.fillStyle=a.color||"#000",t.textAlign=a.textAlign||"left",t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),t.fillText(a.text||"",0,0),t.restore();break;case"image":await new Promise(h=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180);const n=a.width||100,d=a.height||100,p=i.naturalWidth/i.naturalHeight,w=n/d;let S,M,U=0,H=0;p>w?(M=d,S=M*p,U=(n-S)/2):(S=n,M=S/p,H=(d-M)/2),t.beginPath(),t.rect(-n/2,-d/2,n,d),t.clip(),t.drawImage(i,-S/2+U,-M/2+H,S,M),t.restore(),h()},i.src=a.src});break;case"rectangle":t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.fillStyle=a.backgroundColor||"#000",t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),t.fillRect(-(a.width||0)/2,-(a.height||0)/2,a.width||100,a.height||100),t.restore();break;case"circle":t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.fillStyle=a.backgroundColor||"#000",t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),t.beginPath(),t.arc(0,0,(a.width||100)/2,0,2*Math.PI),t.fill(),t.restore();break;case"triangle":t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.fillStyle=a.backgroundColor||"#000",t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),t.beginPath(),t.moveTo(0,-(a.height||100)/2),t.lineTo(-(a.width||100)/2,(a.height||100)/2),t.lineTo((a.width||100)/2,(a.height||100)/2),t.closePath(),t.fill(),t.restore();break;case"star":t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.fillStyle=a.backgroundColor||"#000",t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),Ae(t,0,0,5,(a.width||100)/2,(a.width||100)/4),t.restore();break;case"icon":t.save(),t.font=`${a.fontSize||24}px "Font Awesome 6 Free"`,t.fillStyle=a.color||"#000",t.textAlign="center",t.textBaseline="middle",t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180);const c=a.icon||"★";t.fillText(c,0,0),t.restore();break;case"line":t.save(),t.globalAlpha=a.opacity!==void 0?a.opacity:1,t.fillStyle=a.backgroundColor||a.color||"#6b7280",t.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),t.rotate((a.rotation||0)*Math.PI/180),t.fillRect(-(a.width||200)/2,-(a.height||2)/2,a.width||200,a.height||2),t.restore();break}je(t),Be(o),T.value=e}catch(e){console.error("Export error:",e),alert("خطأ في تصدير التصميم")}},Ae=(e,s,o,t,a,c)=>{let h=Math.PI/2*3,i=s,n=o;const d=Math.PI/t;e.beginPath(),e.moveTo(s,o-a);for(let p=0;p<t;p++)i=s+Math.cos(h)*a,n=o+Math.sin(h)*a,e.lineTo(i,n),h+=d,i=s+Math.cos(h)*c,n=o+Math.sin(h)*c,e.lineTo(i,n),h+=d;e.lineTo(s,o-a),e.closePath(),e.fill()},je=e=>{e.save(),e.font="bold 14px Cairo, sans-serif",e.fillStyle="rgba(0, 0, 0, 0.25)",e.textAlign="right";const s=f.value-15,o=v.value-15;e.translate(s,o),e.rotate(-15*Math.PI/180),e.fillText("سامقة للتصميم",0,0),e.restore()},Be=e=>{const s=document.createElement("a");s.download=`design-${Date.now()}.png`,s.href=e.toDataURL(),s.click()};Je(()=>{Te(),document.addEventListener("keydown",e=>{if(e.ctrlKey||e.metaKey)switch(e.key){case"z":e.preventDefault(),e.shiftKey?X():ae();break;case"y":e.preventDefault(),X();break;case"s":e.preventDefault(),se();break}e.key==="Delete"&&u.value&&Y(u.value.id)})});function W(){r.value.forEach((e,s)=>{e.zIndex=s})}function Re(e){if(!u.value)return;const s=r.value.findIndex(o=>o.id===u.value.id);if(s!==-1){if(e==="front"&&s<r.value.length-1){const o=r.value[s];r.value.splice(s,1),r.value.splice(s+1,0,o),W(),m()}else if(e==="back"&&s>0){const o=r.value[s];r.value.splice(s,1),r.value.splice(s-1,0,o),W(),m()}}}function Oe(){if(!u.value)return;const e={...u.value,id:F()};r.value.push(e),W(),u.value=e,m()}function Ne(){u.value&&(D.value=u.value.id,R.value=!0)}function Fe(e){D.value=e,R.value=!0}function We(){D.value&&(Y(D.value),D.value=null,R.value=!1)}function Ue(){D.value=null,R.value=!1}function He(e){if(u.value){const s=r.value.findIndex(o=>o.id===u.value.id);if(s!==-1){const o=r.value[s];Object.keys(e).forEach(t=>{o[t]=e[t],o.properties&&(o.properties[t]=e[t])}),r.value[s]={...o},m()}}}return(e,s)=>{var o;return x(),b(K,null,[L(ne(Ke),{title:"محرر التصميم المتقدم - إصدار مستقر"},{default:oe(()=>s[2]||(s[2]=[l("link",{href:"https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;600;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Changa:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Cairo+Play:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Reem+Kufi:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Lalezar&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Harmattan:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@400;700&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://fonts.googleapis.com/css2?family=Amiri+Quran&display=swap",rel:"stylesheet"},null,-1),l("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",rel:"stylesheet"},null,-1)])),_:1,__:[2]}),l("div",st,[l("div",lt,[l("div",ot,[l("div",nt,[l("div",it,[s[4]||(s[4]=l("div",{class:"w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center"},[l("i",{class:"fas fa-palette text-white"})],-1)),l("div",null,[s[3]||(s[3]=l("h1",{class:"text-xl font-bold text-gray-800"},"محرر التصميم المتقدم",-1)),l("p",rt,A(q.clientTemplate.name),1),l("p",ct,"العميل: "+A(q.clientTemplate.user.email),1)])]),l("div",dt,[l("div",ut,[l("button",{onClick:ae,disabled:!ee.value,class:"p-2 text-gray-600 hover:text-gray-800 rounded disabled:opacity-50",title:"تراجع"},s[5]||(s[5]=[l("i",{class:"fas fa-undo"},null,-1)]),8,pt),l("button",{onClick:X,disabled:!te.value,class:"p-2 text-gray-600 hover:text-gray-800 rounded disabled:opacity-50",title:"إعادة"},s[6]||(s[6]=[l("i",{class:"fas fa-redo"},null,-1)]),8,gt)]),l("div",ft,[(x(),b(K,null,V(ge,t=>l("button",{key:t.id,onClick:a=>he(t.id),class:j(["p-2 rounded transition-colors",O.value===t.id?"bg-purple-600 text-white":"text-gray-600 hover:text-gray-800"]),title:t.name},[l("i",{class:j(t.icon)},null,2)],10,vt)),64))]),l("button",{onClick:se,disabled:B.value,class:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2 space-x-reverse"},[l("i",{class:j(B.value?"fas fa-spinner fa-spin":"fas fa-save")},null,2),l("span",null,A(B.value?"جاري الحفظ...":"حفظ"),1)],8,ht),l("button",{onClick:Le,class:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 flex items-center space-x-2 space-x-reverse",title:"تصدير التصميم مع العلامة المائية"},s[7]||(s[7]=[l("i",{class:"fas fa-download"},null,-1),l("span",null,"تصدير",-1)])),l("button",{onClick:Me,class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 space-x-reverse"},s[8]||(s[8]=[l("i",{class:"fas fa-eye"},null,-1),l("span",null,"معاينة",-1)])),L(ne(qe),{href:e.route("admin.client-templates.index"),class:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 flex items-center space-x-2 space-x-reverse"},{default:oe(()=>s[9]||(s[9]=[l("i",{class:"fas fa-arrow-right"},null,-1),l("span",null,"رجوع",-1)])),_:1,__:[9]},8,["href"])])])])]),l("div",yt,[l("div",mt,[l("div",xt,[l("div",wt,[(x(),b(K,null,V(pe,t=>l("button",{key:t.id,onClick:a=>z.value=t.id,class:j(["flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-colors",z.value===t.id?"border-purple-600 text-purple-600 bg-purple-50":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"])},[l("i",{class:j([t.icon,"ml-2"])},null,2),Xe(" "+A(t.name),1)],10,bt)),64))])]),l("div",kt,[z.value==="elements"?(x(),b("div",$t,[L(Ze,{onAddElement:xe,onAddBackground:Pe,onAddImage:De})])):I("",!0),z.value==="layers"?(x(),b("div",Ct,[L(Ge,{layers:fe.value,"selected-layer-id":(o=u.value)==null?void 0:o.id,onSelectLayer:be,onRequestDeleteLayer:Fe,onReorderLayers:$e,onUpdateLayer:e.updateLayer,onDuplicateLayer:e.duplicateLayer,onMoveLayerTop:e.moveLayerToTop,onMoveLayerBottom:e.moveLayerToBottom},null,8,["layers","selected-layer-id","onUpdateLayer","onDuplicateLayer","onMoveLayerTop","onMoveLayerBottom"])])):I("",!0),z.value==="properties"?(x(),b("div",_t,[L(Qe,{"selected-element":u.value,onUpdateProperties:He,onMoveLayer:Re,onDuplicateElement:Oe,onRequestDelete:Ne},null,8,["selected-element"])])):I("",!0)])]),l("div",St,[l("div",Mt,[l("div",It,[l("div",zt,[l("div",Tt,[l("button",{onClick:me,class:"p-2 text-gray-600 hover:text-gray-800 rounded"},s[10]||(s[10]=[l("i",{class:"fas fa-search-minus"},null,-1)])),l("span",Et,A(Math.round(y.value*100))+"%",1),l("button",{onClick:ye,class:"p-2 text-gray-600 hover:text-gray-800 rounded"},s[11]||(s[11]=[l("i",{class:"fas fa-search-plus"},null,-1)]))]),l("button",{onClick:s[0]||(s[0]=t=>T.value=!T.value),class:j(["p-2 rounded transition-colors",T.value?"bg-purple-100 text-purple-600":"text-gray-600 hover:text-gray-800"]),title:"تبديل العلامة المائية"},s[12]||(s[12]=[l("i",{class:"fas fa-certificate"},null,-1)]),2)])])]),l("div",Pt,[l("div",{ref_key:"canvasContainer",ref:ue,class:"relative bg-white shadow-lg",style:Z({width:f.value*y.value+"px",height:v.value*y.value+"px",transform:`scale(${y.value})`,transformOrigin:"top left"})},[re.value?(x(),b("div",{key:0,class:"absolute inset-0 pointer-events-none",style:Z(ve.value)},null,4)):I("",!0),l("div",{ref_key:"designCanvas",ref:N,class:"w-full h-full relative overflow-hidden",style:Z({backgroundImage:k.value?`url(${k.value})`:"none",backgroundSize:E.value,backgroundPosition:"center",backgroundRepeat:"no-repeat",cursor:P.value?"crosshair":"default"}),onClick:Ce,onDrop:_e,onDragover:s[1]||(s[1]=ie(()=>{},["prevent"]))},[(x(!0),b(K,null,V(r.value,t=>{var a;return x(),Ve(tt,{key:t.id,element:t,selected:((a=u.value)==null?void 0:a.id)===t.id,zoom:y.value,placementMode:!!P.value,onSelect:we,onUpdate:ke,onDelete:Y},null,8,["element","selected","zoom","placementMode"])}),128)),T.value?(x(),b("div",Dt," سامقة للتصميم ")):I("",!0)],36)],4)])])]),G.value?(x(),b("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ie(le,["self"])},[l("div",Lt,[L(et,{"image-element":Q.value,onSave:Ee},null,8,["image-element"])])])):I("",!0),ce.value?(x(),b("div",At,[l("div",jt,[s[13]||(s[13]=l("i",{class:"fas fa-spinner fa-spin text-2xl text-purple-600"},null,-1)),l("span",Bt,A(de.value),1)])])):I("",!0),R.value?(x(),b("div",Rt,[l("div",{class:"bg-white rounded-lg shadow-lg p-8 max-w-sm w-full text-center"},[s[14]||(s[14]=l("h2",{class:"text-lg font-bold mb-4"},"تأكيد الحذف",-1)),s[15]||(s[15]=l("p",{class:"mb-6"},"هل أنت متأكد أنك تريد حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء.",-1)),l("div",{class:"flex justify-center gap-4"},[l("button",{onClick:We,class:"bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700"},"حذف"),l("button",{onClick:Ue,class:"bg-gray-300 text-gray-700 px-6 py-2 rounded hover:bg-gray-400"},"إلغاء")])])])):I("",!0)])],64)}}},Ut=at(Ot,[["__scopeId","data-v-456dd914"]]);export{Ut as default};
