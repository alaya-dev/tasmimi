import{r as v,c as r,o,a as f,u as D,Z as M,w as j,b as t,d,t as n,n as g,F as p,f as h,h as T,N as $}from"./app-BJSEvLr2.js";import{_ as B}from"./ClientLayout-BKigkkjX.js";import"./DropdownLink-BKuK1C9h.js";import"./useTranslations-CytgtFYN.js";const H={class:"py-12",dir:"rtl"},N={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},A={class:"bg-white shadow-lg rounded-lg overflow-hidden mb-8"},L={class:"p-6"},P={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},V={class:"text-center"},z={class:"text-2xl font-bold text-gray-900 mb-1"},F={class:"text-center"},O={class:"text-center"},R={class:"text-2xl font-bold text-gray-900 mb-1"},E={class:"text-center"},q={key:1,class:"text-center py-8"},G={key:2,class:"mt-6 flex flex-wrap gap-4 justify-center"},K={class:"bg-white shadow-lg rounded-lg overflow-hidden mb-8"},X={class:"overflow-x-auto"},Z={class:"min-w-full divide-y divide-gray-200"},I={class:"bg-white divide-y divide-gray-200"},J={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},U={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},Y={key:0},tt={class:"bg-white shadow-lg rounded-lg overflow-hidden"},et={class:"overflow-x-auto"},st={class:"min-w-full divide-y divide-gray-200"},it={class:"bg-white divide-y divide-gray-200"},rt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},ot={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right"},lt={key:0},dt={class:"mt-3 text-center"},ct={class:"items-center px-4 py-3"},xt=["disabled"],ut={key:0},gt={key:1},vt={__name:"SubscriptionManagement",props:{activeSubscription:{type:Object,default:null},subscriptionHistory:{type:Array,default:()=>[]},paymentHistory:{type:Array,default:()=>[]}},setup(a){const l=v(!1),c=v(!1),x=s=>new Date(s).toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("/"),y=s=>({active:"bg-green-100 text-green-800",canceled:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800"})[s]||"bg-gray-100 text-gray-800",m=s=>({active:"نشط",canceled:"ملغي",expired:"منتهي",pending:"قيد الانتظار"})[s]||s,b=s=>{const i=new Date(s.ends_at)-new Date,_=Math.ceil(i/(1e3*60*60*24));return Math.max(0,_)},w=s=>{const e=b(s);return e<=3?"text-red-600":e<=7?"text-yellow-600":"text-green-600"},k=s=>({card:"بطاقة ائتمان",creditcard:"بطاقة ائتمان",stcpay:"STC Pay",applepay:"Apple Pay"})[s]||s,S=()=>{l.value=!0},C=async()=>{c.value=!0;try{const e=await(await fetch(route("client.subscription.cancel"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();e.success?(l.value=!1,$.reload()):alert(e.error||"حدث خطأ أثناء إلغاء الاشتراك")}catch(s){console.error("Cancel subscription error:",s),alert("حدث خطأ أثناء إلغاء الاشتراك")}finally{c.value=!1}};return(s,e)=>(o(),r(p,null,[f(D(M),{title:"إدارة الاشتراك "}),f(B,null,{default:j(()=>{var u;return[t("div",H,[t("div",N,[e[19]||(e[19]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"إدارة الاشتراك"),t("p",{class:"text-gray-600"},"تحكم في اشتراكك وتاريخ المدفوعات")],-1)),t("div",A,[e[12]||(e[12]=t("div",{class:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4"},[t("h2",{class:"text-xl font-semibold text-white"},"الاشتراك الحالي")],-1)),t("div",L,[a.activeSubscription?(o(),r("div",P,[t("div",V,[t("div",z,n(((u=a.activeSubscription.subscription)==null?void 0:u.name)||"غير محدد"),1),e[5]||(e[5]=t("div",{class:"text-gray-600"},"الخطة الحالية",-1))]),t("div",F,[t("div",{class:g(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium mb-1",y(a.activeSubscription.status)])},n(m(a.activeSubscription.status)),3),e[6]||(e[6]=t("div",{class:"text-gray-600"},"الحالة",-1))]),t("div",O,[t("div",R,n(x(a.activeSubscription.ends_at)),1),e[7]||(e[7]=t("div",{class:"text-gray-600"},"تاريخ الانتهاء",-1))]),t("div",E,[t("div",{class:g(["text-2xl font-bold mb-1",w(a.activeSubscription)])},n(b(a.activeSubscription)),3),e[8]||(e[8]=t("div",{class:"text-gray-600"},"يوم متبقي",-1))])])):(o(),r("div",q,[e[9]||(e[9]=t("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1)),e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"لا يوجد اشتراك نشط",-1)),e[11]||(e[11]=t("p",{class:"text-gray-600 mb-4"},"اشترك الآن للحصول على وصول كامل لجميع الميزات",-1)),t("button",{onClick:e[0]||(e[0]=i=>s.$inertia.visit(s.route("client.subscriptions.index"))),class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," عرض الخطط المتاحة ")])),a.activeSubscription?(o(),r("div",G,[t("button",{onClick:e[1]||(e[1]=i=>s.$inertia.visit(s.route("client.subscriptions.index"))),class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," تغيير الخطة "),a.activeSubscription.status==="active"?(o(),r("button",{key:0,onClick:S,class:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors"}," إلغاء الاشتراك ")):d("",!0)])):d("",!0)])]),t("div",K,[e[15]||(e[15]=t("div",{class:"bg-gray-50 px-6 py-4 border-b"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"تاريخ الاشتراكات")],-1)),t("div",X,[t("table",Z,[e[14]||(e[14]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الخطة "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," تاريخ البداية "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," تاريخ النهاية "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الحالة ")])],-1)),t("tbody",I,[(o(!0),r(p,null,h(a.subscriptionHistory,i=>(o(),r("tr",{key:i.id,class:"hover:bg-gray-50"},[t("td",J,n(i.subscription.name),1),t("td",Q,n(x(i.starts_at)),1),t("td",U,n(x(i.ends_at)),1),t("td",W,[t("span",{class:g(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",y(i.status)])},n(m(i.status)),3)])]))),128)),a.subscriptionHistory.length===0?(o(),r("tr",Y,e[13]||(e[13]=[t("td",{colspan:"4",class:"px-6 py-4 text-center text-gray-500"}," لا يوجد تاريخ اشتراكات ",-1)]))):d("",!0)])])])]),t("div",tt,[e[18]||(e[18]=t("div",{class:"bg-gray-50 px-6 py-4 border-b"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"تاريخ المدفوعات")],-1)),t("div",et,[t("table",st,[e[17]||(e[17]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الخطة "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," المبلغ "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," تاريخ الدفع "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," طريقة الدفع ")])],-1)),t("tbody",it,[(o(!0),r(p,null,h(a.paymentHistory,i=>(o(),r("tr",{key:i.id,class:"hover:bg-gray-50"},[t("td",rt,n(i.subscription.name),1),t("td",ot,n(i.amount)+" "+n(i.currency),1),t("td",at,n(x(i.paid_at)),1),t("td",nt,n(k(i.payment_method)),1)]))),128)),a.paymentHistory.length===0?(o(),r("tr",lt,e[16]||(e[16]=[t("td",{colspan:"4",class:"px-6 py-4 text-center text-gray-500"}," لا يوجد تاريخ مدفوعات ",-1)]))):d("",!0)])])])])])]),l.value?(o(),r("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:e[4]||(e[4]=i=>l.value=!1)},[t("div",{class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:e[3]||(e[3]=T(()=>{},["stop"]))},[t("div",dt,[e[20]||(e[20]=t("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[t("svg",{class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e[21]||(e[21]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900 mt-2"},"تأكيد إلغاء الاشتراك",-1)),e[22]||(e[22]=t("div",{class:"mt-2 px-7 py-3"},[t("p",{class:"text-sm text-gray-500"}," هل أنت متأكد من إلغاء اشتراكك؟ ستفقد الوصول إلى جميع الميزات المدفوعة. ")],-1)),t("div",ct,[t("button",{onClick:C,disabled:c.value,class:"px-4 py-2 bg-red-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-300 disabled:opacity-50"},[c.value?(o(),r("span",ut,"جاري الإلغاء...")):(o(),r("span",gt,"نعم، إلغاء الاشتراك"))],8,xt),t("button",{onClick:e[2]||(e[2]=i=>l.value=!1),class:"mt-3 px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300"}," إلغاء ")])])])])):d("",!0)]}),_:1})],64))}};export{vt as default};
