import{r as f,m as X,p as ut,c as v,o as p,a as W,b as o,w as ft,u as pt,Z as gt,d as $,t as E,F as T,f as R,n as z,j as K,v as se,k as ht,q as Y,h as oe,s as vt,e as pe,g as yt}from"./app-BJSEvLr2.js";import{E as mt,L as bt,P as xt,a as wt,D as kt}from"./DesignElement-afgWAcdT.js";import{_ as $t}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Et={class:"min-h-screen bg-gray-100",dir:"rtl"},Ct={class:"bg-white shadow-sm border-b border-gray-200"},St={class:"max-w-full mx-auto px-6 py-4"},_t={class:"flex justify-between items-center"},Dt={class:"flex items-center space-x-4 space-x-reverse"},zt={class:"text-sm text-gray-600"},Pt={class:"flex items-center space-x-3 space-x-reverse"},Mt={class:"flex items-center bg-gray-100 rounded-lg p-1"},Tt=["disabled"],At=["disabled"],It={class:"flex items-center bg-gray-100 rounded-lg p-1"},Rt=["onClick","title"],Lt=["disabled"],Ft={class:"flex h-screen"},jt={class:"w-80 bg-white border-l border-gray-200 flex flex-col"},Nt={class:"flex-shrink-0 border-b border-gray-200"},Ut={class:"flex"},Bt=["onClick"],Ot={class:"flex-1 overflow-hidden"},Vt={key:0,class:"h-full"},Wt={key:1,class:"h-full"},Ht={key:2,class:"h-full overflow-y-auto"},Gt={class:"p-4 border-b border-gray-200"},Jt={class:"mb-4"},qt={class:"grid grid-cols-2 gap-2"},Xt={key:0,class:"mb-4"},Kt={class:"text-xs text-gray-500 mt-1"},Yt={key:0},Qt={key:1},Zt={key:2},ea={class:"flex-1"},ta={class:"flex-1 bg-gray-50 flex flex-col"},aa={class:"flex-shrink-0 bg-white border-b border-gray-200 p-4"},sa={class:"flex items-center justify-between"},oa={class:"flex items-center space-x-4 space-x-reverse"},na={class:"flex items-center space-x-2 space-x-reverse"},la={class:"text-sm text-gray-600 min-w-16 text-center"},ia={class:"flex-1 overflow-auto p-8 flex items-center justify-center"},ra={key:0,class:"absolute inset-0 pointer-events-none select-none",style:{zIndex:9999,background:`repeating-linear-gradient(
                                        -45deg,
                                        transparent,
                                        transparent 80px,
                                        rgba(0, 0, 0, 0.03) 80px,
                                        rgba(0, 0, 0, 0.03) 160px
                                    )`,userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"}},ca={class:"bg-white rounded-lg shadow-xl max-w-6xl max-h-[90vh] w-full mx-4"},da={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40"},ua={class:"bg-white rounded-lg p-8 flex items-center space-x-4 space-x-reverse"},fa={class:"text-lg font-medium"},pa={key:2,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},ga={class:"mb-6"},ha={class:"grid grid-cols-2 gap-3"},va=["onClick"],ya={class:"font-medium text-sm"},ma={class:"text-xs text-gray-500 mt-1"},ba={key:0},xa={class:"mb-6"},wa={class:"grid grid-cols-2 gap-3"},ka=["onClick"],$a={class:"font-medium"},Ea={class:"text-xs text-gray-500"},Ca={key:0,class:"mb-6"},Sa={class:"text-center text-sm text-gray-600 mt-1"},_a={class:"flex space-x-3 space-x-reverse"},Da=["disabled"],za={key:0},Pa={key:1},Ma={__name:"StableDesignEditor",props:{template:{type:Object,required:!0},context:{type:String,default:"admin",validator:L=>["admin","admin-client","client"].includes(L)},user:{type:Object,default:null},hasActiveSubscription:{type:Boolean,default:!0},templatePrice:{type:Number,default:0},canSaveAndDownload:{type:Boolean,default:!0}},emits:["save","update","export"],setup(L,{emit:ge}){const k=L,he=ge,P=f("elements"),H=f("desktop"),b=f(1),ve=f(!1);f(!1);const g=f(800),d=f(600),F=f(!1),ye=f(!1),me=f(""),ne=f(!1),le=f(null),x=f(""),C=f("contain"),A=f(null),j=f(!1),I=f(null),N=f(!1),U=f("png"),ie=f("current"),G=f(90),B=f(!1),l=f([]),y=f(null),D=f([]),_=f(-1),be=f(null),Q=f(null),xe=[{id:"elements",name:"Ø§Ù„Ø¹Ù†Ø§ØµØ±",icon:"fas fa-shapes"},{id:"layers",name:"Ø§Ù„Ø·Ø¨Ù‚Ø§Øª",icon:"fas fa-layer-group"},{id:"properties",name:"Ø§Ù„Ø®ØµØ§Ø¦Øµ",icon:"fas fa-cog"}],we=[{id:"desktop",name:"Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨",icon:"fas fa-desktop"},{id:"tablet",name:"ØªØ§Ø¨Ù„Øª",icon:"fas fa-tablet-alt"},{id:"mobile",name:"Ù…ÙˆØ¨Ø§ÙŠÙ„",icon:"fas fa-mobile-alt"}],ke=[{value:"png",label:"PNG",description:"Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ù…Ø¹ Ø´ÙØ§ÙÙŠØ©",icon:"fas fa-file-image"},{value:"jpeg",label:"JPEG",description:"Ø­Ø¬Ù… Ø£ØµØºØ± Ù„Ù„ØµÙˆØ±",icon:"fas fa-image"},{value:"svg",label:"SVG",description:"Ø±Ø³ÙˆÙ…ÙŠØ§Øª Ù…ØªØ¬Ù‡Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙƒØ¨ÙŠØ±",icon:"fas fa-vector-square"},{value:"pdf",label:"PDF",description:"Ù…Ø³ØªÙ†Ø¯ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©",icon:"fas fa-file-pdf"}],$e=[{value:"current",label:"Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ",width:null,height:null},{value:"hd",label:"HD",width:1920,height:1080,dpi:72},{value:"print_a4",label:"A4 Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©",width:2480,height:3508,dpi:300},{value:"social_post",label:"Ù…Ù†Ø´ÙˆØ± Ø³ÙˆØ´ÙŠØ§Ù„",width:1080,height:1080,dpi:72},{value:"story",label:"Ø³ØªÙˆØ±ÙŠ",width:1080,height:1920,dpi:72},{value:"banner",label:"Ø¨Ø§Ù†Ø±",width:1200,height:400,dpi:72}],re=X(()=>_.value>0),ce=X(()=>_.value<D.value.length-1),Ee=X(()=>l.value.map((t,e)=>({id:t.id,name:t.name||`Ø¹Ù†ØµØ± ${e+1}`,type:t.type,visible:t.visible!==!1,locked:t.locked||!1}))),Ce=X(()=>{const t=20*b.value;return{backgroundImage:`
            linear-gradient(to right, #e5e7eb 1px, transparent 1px),
            linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)
        `,backgroundSize:`${t}px ${t}px`}}),Se=t=>{switch(H.value=t,t){case"desktop":g.value=1200,d.value=800;break;case"tablet":g.value=768,d.value=1024;break;case"mobile":g.value=375,d.value=667;break}},_e=()=>{b.value=Math.min(b.value+.1,3)},De=()=>{b.value=Math.max(b.value-.1,.1)},ze=t=>{if(t.type==="image"){const e={id:J(),type:t.type,name:t.name,x:g.value/2-100,y:d.value/2-100,width:t.width||200,height:t.height||100,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:l.value.length,...t.properties};l.value.push(e),y.value=e,w()}else A.value=t},Pe=t=>{y.value={...t,properties:t.properties?{...t.properties}:void 0},P.value="properties"},Me=t=>{const e=l.value.find(a=>a.id===t);e&&(y.value={...e,properties:e.properties?{...e.properties}:void 0},P.value="properties")},Te=(t,e)=>{const a=l.value.findIndex(s=>s.id===t);a!==-1&&(l.value[a]={...l.value[a],...e},w())},Z=t=>{var a;const e=l.value.findIndex(s=>s.id===t);e!==-1&&(l.value.splice(e,1),((a=y.value)==null?void 0:a.id)===t&&(y.value=null),w())},Ae=t=>{const e=t.map(a=>l.value.find(s=>s.id===a)).filter(Boolean);l.value=e,q(),w()},Ie=t=>{if(A.value){const e=Q.value.getBoundingClientRect(),a=(t.clientX-e.left)/b.value,s=(t.clientY-e.top)/b.value,n=A.value,i={id:J(),type:n.type,name:n.name,x:a,y:s,width:n.width||200,height:n.height||100,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:l.value.length,...n.properties};l.value.push(i),y.value=i,w(),A.value=null}else t.target===Q.value&&(y.value=null)},Re=t=>{t.preventDefault(),Array.from(t.dataTransfer.files).forEach(a=>{if(a.type.startsWith("image/")){const s=new FileReader;s.onload=n=>{const i={id:J(),type:"image",name:a.name,x:t.offsetX,y:t.offsetY,width:300,height:200,rotation:0,opacity:1,visible:!0,locked:!1,zIndex:l.value.length,src:n.target.result};l.value.push(i),y.value=i,w()},s.readAsDataURL(a)}})},w=()=>{D.value=D.value.slice(0,_.value+1),D.value.push(JSON.parse(JSON.stringify(l.value))),_.value++,D.value.length>50&&(D.value.shift(),_.value--)},de=()=>{re.value&&(_.value--,l.value=JSON.parse(JSON.stringify(D.value[_.value])),y.value=null)},ee=()=>{ce.value&&(_.value++,l.value=JSON.parse(JSON.stringify(D.value[_.value])),y.value=null)},J=()=>"element_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),Le=(t,e=800,a=.7)=>new Promise(s=>{if(!t.startsWith("data:image/")){s(t);return}const n=new Image;n.onload=()=>{const i=document.createElement("canvas"),h=i.getContext("2d");let{width:r,height:c}=n;const u=t.length;u>1e6?(e=600,a=.5):u>5e5&&(e=700,a=.6),(r>e||c>e)&&(r>c?(c=c*e/r,r=e):(r=r*e/c,c=e)),i.width=r,i.height=c,h.drawImage(n,0,0,r,c);const m=i.toDataURL("image/jpeg",a);console.log(`Image compressed: ${Math.round(u/1024)}KB -> ${Math.round(m.length/1024)}KB`),s(m)},n.src=t}),ue=async()=>{F.value=!0;try{console.log("Compressing images...");const t=await Promise.all((l.value||[]).map(async s=>{if(s.type==="image"&&s.src&&s.src.startsWith("data:image/")){const n=await Le(s.src);return{...s,src:n}}return s}));console.log("Image compression complete");const e={elements:t,canvas:{width:g.value||800,height:d.value||600,background:x.value||"",backgroundSize:C.value||"contain"},settings:{device:H.value||"desktop",zoom:b.value||1},watermark:{text:"Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ…",enabled:!0,position:"bottom-right",style:{fontSize:"14px",color:"rgba(0, 0, 0, 0.25)",fontFamily:"Cairo, sans-serif",fontWeight:"bold",rotation:"-15deg"}}};let a;try{a=JSON.stringify(e);const s=new Blob([a]).size;if(s>16777215)throw new Error(`Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (${Math.round(s/1024/1024)}MB). ÙŠØ±Ø¬Ù‰ ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±.`)}catch(s){throw new Error("Invalid design data: "+s.message)}console.log("Emitting save event with design data"),console.log("Data size:",Math.round(new Blob([a]).size/1024),"KB"),he("save",{designData:e,designDataString:a,canvasSize:`${g.value}x${d.value}`,designNotes:`ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙÙŠ ${new Date().toLocaleString("ar-SA")}`}),console.log("âœ… Design save event emitted successfully")}catch(t){console.error("âŒ Error preparing design save:",t);let e="Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ØªØµÙ…ÙŠÙ…";t.message&&(e+=": "+t.message),alert(e)}finally{F.value=!1}},Fe=()=>{window.history.back()},je=t=>{const e=`
        left: ${t.x}px;
        top: ${t.y}px;
        width: ${t.width}px;
        height: ${t.height}px;
        transform: rotate(${t.rotation}deg);
        opacity: ${t.opacity};
        z-index: ${t.zIndex};
    `;switch(t.type){case"text":return`<div class="element" style="${e} font-size: ${t.fontSize||16}px; color: ${t.color||"#000"}; font-weight: ${t.fontWeight||"normal"}; font-family: ${t.fontFamily||"Cairo, sans-serif"}; text-align: ${t.textAlign||"right"};">${t.text||"Ù†Øµ"}</div>`;case"image":return`<img class="element" src="${t.src}" style="${e} object-fit: cover;" alt="${t.name}">`;case"rectangle":return`<div class="element" style="${e} background-color: ${t.backgroundColor||"#000"}; border-radius: ${t.borderRadius||0}px;"></div>`;case"circle":return`<div class="element" style="${e} background-color: ${t.backgroundColor||"#10b981"}; border-radius: 50%;"></div>`;case"shape":return Ne(t,e);case"icon":const a=te(t),s=t.fontSize!==void 0&&t.fontSize!==null&&t.fontSize>0?t.fontSize:Math.min(t.width||50,t.height||50);return`<div class="element" style="${e} display: flex; align-items: center; justify-content: center; font-size: ${s}px; color: ${t.color||t.backgroundColor||"#374151"};">
                ${a}
            </div>`;default:return""}},Ne=(t,e)=>{const a=t.shapeType||"rectangle",s=t.backgroundColor||t.color||"#8b5cf6",n=t.width||50,i=t.height||50;switch(a){case"circle":return`<div class="element" style="${e} background-color: ${s}; border-radius: 50%;"></div>`;case"triangle":return`<div class="element" style="${e} width: 0; height: 0; border-left: ${n/2}px solid transparent; border-right: ${n/2}px solid transparent; border-bottom: ${i}px solid ${s}; background: none;"></div>`;case"diamond":return`<div class="element" style="${e} background-color: ${s}; transform: rotate(45deg) rotate(${t.rotation||0}deg);"></div>`;case"star":return`<div class="element" style="${e} display: flex; align-items: center; justify-content: center; color: ${s}; font-size: ${n*.8}px; background: none;">
                â˜…
            </div>`;case"arrow":return`<div class="element" style="${e} display: flex; align-items: center; justify-content: center; color: ${s}; font-size: ${n*.6}px; background: none;">
                â†’
            </div>`;default:return`<div class="element" style="${e} background-color: ${s};"></div>`}},Ue=()=>{if(k.template.design_data)try{let t;if(typeof k.template.design_data=="string")t=JSON.parse(k.template.design_data);else if(typeof k.template.design_data=="object")t=k.template.design_data;else throw new Error("Invalid design data format");l.value=t.elements||[],t.canvas&&(g.value=t.canvas.width||800,d.value=t.canvas.height||600,x.value=t.canvas.background||"",C.value=t.canvas.backgroundSize||"contain"),t.settings&&(H.value=t.settings.device||"desktop",b.value=t.settings.zoom||1),w()}catch(t){console.error("Error loading design:",t),l.value=[],w()}else w()},fe=()=>{ne.value=!1,le.value=null},Be=t=>{console.log("Photo edited:",t),fe()};function Oe(t){x.value=t}function Ve(t){const e={id:Date.now(),type:"image",src:t,x:g.value/2-100,y:d.value/2-100,width:200,height:200,name:"ØµÙˆØ±Ø©"};l.value.push(e),y.value=e}const We=()=>{x.value="",C.value="contain",w()},He=(t,e=null)=>{const a=document.createElement("a");a.download=e?`${e}-${Date.now()}.png`:`design-${Date.now()}.png`,a.href=t.toDataURL(),a.click()},te=t=>{if(t.icon&&(t.icon.length===1||t.icon.length===2))return t.icon;if(t.iconClass){const e={"fas fa-star":"â˜…","fas fa-heart":"â¤","fas fa-circle":"â—","fas fa-square":"â– ","fas fa-diamond":"â™¦","fas fa-arrow-right":"â†’","fas fa-arrow-left":"â†","fas fa-arrow-up":"â†‘","fas fa-arrow-down":"â†“","fas fa-chevron-right":"â€º","fas fa-chevron-left":"â€¹","fas fa-chevron-up":"âŒƒ","fas fa-chevron-down":"âŒ„","fas fa-check":"âœ“","fas fa-times":"âœ•","fas fa-plus":"+","fas fa-minus":"âˆ’","fas fa-edit":"âœ","fas fa-trash":"ğŸ—‘","fas fa-save":"ğŸ’¾","fas fa-download":"â¬‡","fas fa-upload":"â¬†","fas fa-search":"ğŸ”","fas fa-cog":"âš™","fas fa-settings":"âš™","fas fa-gear":"âš™","fas fa-home":"ğŸ ","fas fa-user":"ğŸ‘¤","fas fa-envelope":"âœ‰","fas fa-phone":"ğŸ“","fas fa-message":"ğŸ’¬","fas fa-comment":"ğŸ’¬","fas fa-mail":"ğŸ“§","fas fa-users":"ğŸ‘¥","fas fa-group":"ğŸ‘¥","fas fa-camera":"ğŸ“·","fas fa-music":"ğŸµ","fas fa-video":"ğŸ¥","fas fa-image":"ğŸ–¼","fas fa-file":"ğŸ“„","fas fa-folder":"ğŸ“","fas fa-play":"â–¶","fas fa-pause":"â¸","fas fa-stop":"â¹","fas fa-car":"ğŸš—","fas fa-plane":"âœˆ","fas fa-train":"ğŸš‚","fas fa-ship":"ğŸš¢","fas fa-bicycle":"ğŸš²","fas fa-trophy":"ğŸ†","fas fa-gift":"ğŸ","fas fa-key":"ğŸ”‘","fas fa-lock":"ğŸ”’","fas fa-unlock":"ğŸ”“","fas fa-bell":"ğŸ””","fas fa-clock":"ğŸ•","fas fa-calendar":"ğŸ“…","fas fa-location-dot":"ğŸ“","fas fa-graduation-cap":"ğŸ“","fas fa-shopping-cart":"ğŸ›’","fas fa-cart":"ğŸ›’","fas fa-basket":"ğŸ§º","fas fa-sun":"â˜€","fas fa-moon":"ğŸŒ™","fas fa-cloud":"â˜","fas fa-umbrella":"â˜‚","fas fa-coffee":"â˜•","fas fa-apple":"ğŸ","fas fa-cake":"ğŸ‚","fas fa-info":"â„¹","fas fa-warning":"âš ","fas fa-exclamation":"!","fas fa-question":"?","fas fa-lightbulb":"ğŸ’¡","fas fa-bulb":"ğŸ’¡","fas fa-message":"ğŸ’¬","fas fa-comment":"ğŸ’¬","fas fa-users":"ğŸ‘¥","fas fa-group":"ğŸ‘¥","fas fa-image":"ğŸ–¼","fas fa-play":"â–¶","fas fa-pause":"â¸","fas fa-stop":"â¹","fas fa-money":"ğŸ’°","fas fa-store":"ğŸª","fas fa-bicycle":"ğŸš²","fas fa-train":"ğŸš‚","fas fa-book":"ğŸ“š","fas fa-pencil":"âœ","fas fa-smile":"ğŸ˜Š","fas fa-thumbs-up":"ğŸ‘","fas fa-rain":"ğŸŒ§","fas fa-pizza":"ğŸ•","fas fa-key":"ğŸ”‘","fas fa-lock":"ğŸ”’","fas fa-unlock":"ğŸ”“"},a=t.iconClass.trim().toLowerCase();if(e[a])return e[a];if(!a.startsWith("fas ")&&!a.startsWith("far ")&&!a.startsWith("fab ")&&!a.startsWith("fal ")){const s=`fas ${a}`;if(e[s])return e[s];{const i=`fas fa-${a.replace(/^fa-/,"")}`;return e[i]||"â—"}}else{const n=`fas ${a.replace(/^(fas|far|fab|fal)\s+/,"")}`;return e[n]||"â—"}}return"â—"},Ge=async()=>{try{console.log("ğŸ” ===== PREVIEW DESIGN ADVANCED DÃ‰MARRÃ‰ =====");const t={elements:l.value,canvas:{width:g.value,height:d.value,background:x.value||"",backgroundSize:C.value||"contain"},watermark:{text:"Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ…",enabled:!0,position:"bottom-right",style:{fontSize:"14px",color:"rgba(0, 0, 0, 0.25)",fontFamily:"Cairo, sans-serif",fontWeight:"bold",rotation:"-15deg"}}},e=Je(t);console.log("- HTML gÃ©nÃ©rÃ©, longueur:",e.length),window.open("","_blank","width=1000,height=800").document.write(e),console.log("âœ… ===== PREVIEW TERMINÃ‰ AVEC SUCCÃˆS (AFFICHAGE SEULEMENT) =====")}catch(t){console.error("âŒ ERREUR PENDANT PREVIEW:",t),alert("Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØµÙ…ÙŠÙ…: "+t.message)}},Je=t=>{var r,c;let e=`
        <!DOCTYPE html>
        <html dir="rtl">
        <head>
            <meta charset="UTF-8">
            <title>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØµÙ…ÙŠÙ… - Ø¥Ø¯Ø§Ø±Ø©</title>
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
                body {
                    margin: 0;
                    padding: 20px;
                    font-family: 'Cairo', sans-serif;
                    background: #f5f5f5;
                }
                .canvas {
                    width: ${t.canvas.width}px;
                    height: ${t.canvas.height}px;
                    position: relative;
                    background: white;
                    border: 1px solid #ddd;
                    margin: 0 auto;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                    ${x.value?`
                        background-image: url(${x.value});
                        background-size: ${C.value};
                        background-position: center;
                        background-repeat: no-repeat;
                    `:""}
                }
                .element { position: absolute; }
                h2 { text-align: center; color: #333; margin-bottom: 20px; }
                .footer {
                    text-align: center;
                    margin-top: 20px;
                    color: #666;
                    font-size: 12px;
                }
                .admin-badge {
                    position: fixed;
                    top: 20px;
                    left: 20px;
                    background: linear-gradient(45deg, #8b5cf6, #ec4899);
                    color: white;
                    padding: 8px 16px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: bold;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                }
            </style>
        </head>
        <body>
            <div class="admin-badge">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            <h2>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØµÙ…ÙŠÙ… - Ø³Ø§Ù…Ù‚Ø© (Ø¥Ø¯Ø§Ø±Ø©)</h2>
            <div class="canvas">
    `;t.elements.forEach(u=>{u.visible!==!1&&(e+=je(u))});const a=120,s=((r=t.canvas)==null?void 0:r.width)||800,n=((c=t.canvas)==null?void 0:c.height)||600,i=Math.sqrt(s*s+n*n),h=Math.ceil(i/a);console.log("ğŸ” Advanced Preview Watermark Debug:",{canvasW:s,canvasH:n,diagonal:i,count:h,spacing:a}),e+='<div style="position: absolute; inset: 0; pointer-events: none; z-index: 9999;">';for(let u=0;u<h-3;u++){const m=(u+3)*a-n/2,S=n/2;e+=`
            <div style="
                position: absolute;
                left: ${m}px;
                top: ${S}px;
                font-size: 16px;
                color: rgba(0, 0, 0, 0.2);
                font-family: 'Cairo', sans-serif;
                font-weight: bold;
                transform: rotate(-45deg) translateY(-50%);
                transform-origin: left center;
                white-space: nowrap;
                letter-spacing: 2px;
                user-select: none;
                pointer-events: none;
            ">Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ…</div>`}return e+="</div>",e+=`
            </div>
            <div class="footer">
                ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù†ØµØ© Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ… - Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©<br>

            </div>
        </body>
        </html>
    `,e},qe=t=>{const e=`translate(${t.x+(t.width||0)/2}, ${t.y+(t.height||0)/2}) rotate(${t.rotation||0})`;switch(t.type){case"text":return`<text x="0" y="0" transform="${e}"
                font-family="${t.fontFamily||"Cairo, sans-serif"}"
                font-size="${t.fontSize||16}"
                font-weight="${t.fontWeight||"normal"}"
                fill="${t.color||"#000"}"
                text-anchor="middle"
                dominant-baseline="central"
                opacity="${t.opacity!==void 0?t.opacity:1}">
                ${t.text||""}
            </text>`;case"rectangle":return`<rect x="${-(t.width||0)/2}" y="${-(t.height||0)/2}"
                width="${t.width||100}" height="${t.height||100}"
                fill="${t.backgroundColor||"#000"}"
                transform="${e}"
                opacity="${t.opacity!==void 0?t.opacity:1}"/>`;case"circle":return`<circle cx="0" cy="0"
                r="${Math.min(t.width||100,t.height||100)/2}"
                fill="${t.backgroundColor||"#10b981"}"
                transform="${e}"
                opacity="${t.opacity!==void 0?t.opacity:1}"/>`;case"shape":return Xe(t,e);case"icon":const a=te(t);return`<text x="0" y="0" text-anchor="middle" dominant-baseline="central"
                font-size="${t.fontSize!==void 0&&t.fontSize!==null&&t.fontSize>0?t.fontSize:Math.min(t.width||50,t.height||50)}"
                fill="${t.color||t.backgroundColor||"#374151"}"
                transform="${e}"
                opacity="${t.opacity!==void 0?t.opacity:1}">
                ${a}
            </text>`;case"image":return`<image href="${t.src}"
                x="${-(t.width||0)/2}" y="${-(t.height||0)/2}"
                width="${t.width||100}" height="${t.height||100}"
                transform="${e}"
                opacity="${t.opacity!==void 0?t.opacity:1}"/>`;default:return""}},Xe=(t,e)=>{const a=t.shapeType||"rectangle",s=t.width||50,n=t.height||50,i=t.backgroundColor||t.color||"#8b5cf6",h=t.opacity!==void 0?t.opacity:1;switch(a){case"circle":return`<circle cx="0" cy="0"
                r="${Math.min(s,n)/2}"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`;case"triangle":return`<polygon points="0,${-n/2} ${-s/2},${n/2} ${s/2},${n/2}"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`;case"diamond":return`<polygon points="0,${-n/2} ${s/2},0 0,${n/2} ${-s/2},0"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`;case"star":const r=Math.min(s,n)/2,c=r*.4;let u="";for(let M=0;M<10;M++){const O=M*Math.PI/5-Math.PI/2,V=M%2===0?r:c,ct=Math.cos(O)*V,dt=Math.sin(O)*V;u+=`${ct},${dt} `}return`<polygon points="${u.trim()}"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`;case"arrow":const m=s,S=n;return`<polygon points="${-m/2},${-S/4} ${m/4},${-S/4} ${m/4},${-S/2} ${m/2},0 ${m/4},${S/2} ${m/4},${S/4} ${-m/2},${S/4}"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`;default:return`<rect x="${-s/2}" y="${-n/2}"
                width="${s}" height="${n}"
                fill="${i}"
                transform="${e}"
                opacity="${h}"/>`}},ae=async()=>{console.log("ğŸ¨ ===== CREATE ADVANCED PREVIEW CANVAS DÃ‰MARRÃ‰ =====");const t=document.createElement("canvas"),e=t.getContext("2d");t.width=g.value,t.height=d.value,console.log(`ğŸ“ Canvas crÃ©Ã© avec dimensions: ${t.width}x${t.height}`),e.fillStyle="#ffffff",e.fillRect(0,0,g.value,d.value),console.log("âœ… Fond blanc appliquÃ©"),x.value&&await new Promise(a=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>{if(C.value==="contain"){const n=g.value/d.value,i=s.width/s.height;let h,r,c,u;i>n?(h=g.value,r=g.value/i,c=0,u=(d.value-r)/2):(h=d.value*i,r=d.value,c=(g.value-h)/2,u=0),e.drawImage(s,c,u,h,r)}else if(C.value==="cover"){const n=g.value/d.value,i=s.width/s.height;let h,r,c,u;i>n?(r=d.value,h=d.value*i,c=(g.value-h)/2,u=0):(h=g.value,r=g.value/i,c=0,u=(d.value-r)/2),e.drawImage(s,c,u,h,r)}else e.drawImage(s,0,0,g.value,d.value);a()},s.onerror=()=>a(),s.src=x.value}),console.log(`Dessin de ${l.value.length} Ã©lÃ©ments sur le canvas d'export`);for(const a of l.value){if(a.visible===!1){console.log(`Ã‰lÃ©ment ${a.id} ignorÃ© car non visible`);continue}switch(console.log(`Dessin Ã©lÃ©ment ${a.id} (${a.type})`),a.type){case"text":e.save(),e.font=`${a.fontWeight||"normal"} ${a.fontSize||16}px ${a.fontFamily||"Cairo, sans-serif"}`,e.fillStyle=a.color||"#000",e.textAlign=a.textAlign||"left",e.globalAlpha=a.opacity!==void 0?a.opacity:1,e.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),e.rotate((a.rotation||0)*Math.PI/180),e.fillText(a.content||a.text||"",-(a.width||0)/2,0),e.restore();break;case"image":a.src&&await new Promise(h=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{e.save(),e.globalAlpha=a.opacity!==void 0?a.opacity:1,e.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),e.rotate((a.rotation||0)*Math.PI/180),e.drawImage(r,-(a.width||0)/2,-(a.height||0)/2,a.width||100,a.height||100),e.restore(),h()},r.onerror=()=>h(),r.src=a.src});break;case"rectangle":case"shape":case"circle":switch(e.save(),e.globalAlpha=a.opacity!==void 0?a.opacity:1,e.fillStyle=a.backgroundColor||a.color||"#000",e.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),e.rotate((a.rotation||0)*Math.PI/180),a.shapeType||(a.type==="circle"?"circle":"rectangle")){case"circle":e.beginPath(),e.arc(0,0,Math.min(a.width||50,a.height||50)/2,0,2*Math.PI),e.fill();break;case"triangle":e.beginPath(),e.moveTo(0,-(a.height||50)/2),e.lineTo(-(a.width||50)/2,(a.height||50)/2),e.lineTo((a.width||50)/2,(a.height||50)/2),e.closePath(),e.fill();break;case"diamond":e.beginPath(),e.moveTo(0,-(a.height||50)/2),e.lineTo((a.width||50)/2,0),e.lineTo(0,(a.height||50)/2),e.lineTo(-(a.width||50)/2,0),e.closePath(),e.fill();break;case"star":const h=Math.min(a.width||50,a.height||50)/2,r=h*.4;e.beginPath();for(let m=0;m<10;m++){const S=m*Math.PI/5,M=m%2===0?h:r,O=Math.cos(S-Math.PI/2)*M,V=Math.sin(S-Math.PI/2)*M;m===0?e.moveTo(O,V):e.lineTo(O,V)}e.closePath(),e.fill();break;case"arrow":const c=a.width||50,u=a.height||50;e.beginPath(),e.moveTo(-c/2,-u/4),e.lineTo(c/4,-u/4),e.lineTo(c/4,-u/2),e.lineTo(c/2,0),e.lineTo(c/4,u/2),e.lineTo(c/4,u/4),e.lineTo(-c/2,u/4),e.closePath(),e.fill();break;default:e.fillRect(-(a.width||0)/2,-(a.height||0)/2,a.width||100,a.height||100)}e.restore();break;case"line":e.save(),e.globalAlpha=a.opacity!==void 0?a.opacity:1,e.strokeStyle=a.backgroundColor||a.color||"#6b7280",e.lineWidth=a.height||2,e.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),e.rotate((a.rotation||0)*Math.PI/180),e.beginPath(),e.moveTo(-(a.width||200)/2,0),e.lineTo((a.width||200)/2,0),e.stroke(),e.restore();break;case"icon":e.save(),e.globalAlpha=a.opacity!==void 0?a.opacity:1,e.translate(a.x+(a.width||0)/2,a.y+(a.height||0)/2),e.rotate((a.rotation||0)*Math.PI/180);const n=te(a);e.fillStyle=a.color||a.backgroundColor||"#374151";const i=a.fontSize!==void 0&&a.fontSize!==null&&a.fontSize>0?a.fontSize:Math.min(a.width||50,a.height||50);e.font=`${i}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(n,0,0),e.restore();break}}return console.log("âœ… Canvas d'export crÃ©Ã© avec succÃ¨s"),t},Ke=async()=>{if(console.log("ğŸš€ ===== EXPORT DESIGN AVEC FORMAT DÃ‰MARRÃ‰ (ADMIN) ====="),B.value){console.log("âš ï¸ Export dÃ©jÃ  en cours, abandon");return}B.value=!0;try{switch(await vt(),console.log(`ğŸ¯ Lancement export format: ${U.value}`),U.value){case"png":await Ye();break;case"jpeg":await Qe();break;case"svg":await Ze();break;case"pdf":await et();break}N.value=!1,console.log("âœ… ===== EXPORT TERMINÃ‰ AVEC SUCCÃˆS (ADMIN) =====")}catch(t){console.error("âŒ ===== ERREUR PENDANT EXPORT (ADMIN) ====="),console.error("DÃ©tails de l'erreur:",t),alert("Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„ØªØµÙ…ÙŠÙ…: "+t.message)}finally{B.value=!1}},Ye=async()=>{const t=await ae();He(t,"admin-design-png")},Qe=async()=>{const t=await ae(),e=document.createElement("a");e.download=`admin-design-jpeg-${Date.now()}.jpg`,e.href=t.toDataURL("image/jpeg",G.value/100),e.click()},Ze=async()=>{console.log("ğŸ¨ ===== SVG EXPORT DÃ‰MARRÃ‰ =====");let t=`<svg width="${g.value}" height="${d.value}" xmlns="http://www.w3.org/2000/svg">`;t+='<rect width="100%" height="100%" fill="white"/>',x.value&&(t+=`<image href="${x.value}" width="${g.value}" height="${d.value}"/>`),l.value.forEach(s=>{s.visible!==!1&&(t+=qe(s))}),t+="</svg>";const e=new Blob([t],{type:"image/svg+xml"}),a=document.createElement("a");a.download=`admin-design-${Date.now()}.svg`,a.href=URL.createObjectURL(e),a.click(),URL.revokeObjectURL(a.href),console.log("âœ… SVG Export terminÃ©")},et=async()=>{console.log("ğŸ“„ ===== PDF EXPORT DÃ‰MARRÃ‰ =====");try{const e=(await ae()).toDataURL("image/png"),a=g.value,s=d.value,n=window.open("","_blank"),i='<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ØªØµÙ…ÙŠÙ… Ø³Ø§Ù…Ù‚Ø©</title><style>@page { margin: 0; size: '+a+"px "+s+"px; }body { margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }.design-container { width: "+a+"px; height: "+s+'px; position: relative; }.design-image { width: 100%; height: 100%; object-fit: contain; }.print-info { position: absolute; bottom: 10px; right: 10px; font-size: 10px; color: rgba(0,0,0,0.5); font-family: Arial, sans-serif; }</style></head><body><div class="design-container"><img src="'+e+'" alt="ØªØµÙ…ÙŠÙ… Ø³Ø§Ù…Ù‚Ø©" class="design-image"><div class="print-info">ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù†ØµØ© Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ…</div></div><script>window.onload = function() { setTimeout(function() { window.print(); }, 1000); }<\/script></body></html>';n.document.write(i),n.document.close(),console.log("âœ… PDF Export terminÃ© (ouverture pour impression)")}catch(t){console.error("âŒ Erreur PDF Export:",t),alert("Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± PDF: "+t.message)}},tt=()=>{k.context==="client"&&k.template.id&&(window.location.href=`/client/templates/${k.template.id}/purchase`)};ut(()=>{Ue(),document.addEventListener("keydown",t=>{if(t.ctrlKey||t.metaKey)switch(t.key){case"z":t.preventDefault(),t.shiftKey?ee():de();break;case"y":t.preventDefault(),ee();break;case"s":t.preventDefault(),ue();break}t.key==="Delete"&&y.value&&Z(y.value.id)})});function q(){l.value.forEach((t,e)=>{t.zIndex=e})}function at(t){if(!y.value)return;const e=l.value.findIndex(a=>a.id===y.value.id);if(e!==-1){if(t==="front"&&e<l.value.length-1){const a=l.value[e];l.value.splice(e,1),l.value.splice(e+1,0,a),q(),w()}else if(t==="back"&&e>0){const a=l.value[e];l.value.splice(e,1),l.value.splice(e-1,0,a),q(),w()}}}function st(){if(!y.value)return;const t={...y.value,id:J()};l.value.push(t),q(),y.value=t,w()}function ot(){y.value&&(I.value=y.value.id,j.value=!0)}function nt(t){I.value=t,j.value=!0}function lt(){I.value&&(Z(I.value),I.value=null,j.value=!1)}function it(){I.value=null,j.value=!1}function rt(t){if(y.value){const e=l.value.findIndex(a=>a.id===y.value.id);if(e!==-1){const a=l.value[e];Object.keys(t).forEach(s=>{a[s]=t[s],a.properties&&(a.properties[s]=t[s])}),l.value[e]={...a},w()}}}return(t,e)=>{var a;return p(),v(T,null,[W(pt(gt),{title:"Ù…Ø­Ø±Ø± Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - Ø¥ØµØ¯Ø§Ø± Ù…Ø³ØªÙ‚Ø±"},{default:ft(()=>e[9]||(e[9]=[o("link",{href:"https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;600;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Changa:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Cairo+Play:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Reem+Kufi:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Lalezar&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Harmattan:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@400;700&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://fonts.googleapis.com/css2?family=Amiri+Quran&display=swap",rel:"stylesheet"},null,-1),o("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",rel:"stylesheet"},null,-1)])),_:1,__:[9]}),o("div",Et,[o("div",Ct,[o("div",St,[o("div",_t,[o("div",Dt,[e[11]||(e[11]=o("div",{class:"w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center"},[o("i",{class:"fas fa-palette text-white"})],-1)),o("div",null,[e[10]||(e[10]=o("h1",{class:"text-xl font-bold text-gray-800"},"Ù…Ø­Ø±Ø± Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…",-1)),o("p",zt,E(L.template.name),1)])]),o("div",Pt,[o("div",Mt,[o("button",{onClick:de,disabled:!re.value,class:"p-2 text-gray-600 hover:text-gray-800 rounded disabled:opacity-50",title:"ØªØ±Ø§Ø¬Ø¹"},e[12]||(e[12]=[o("i",{class:"fas fa-undo"},null,-1)]),8,Tt),o("button",{onClick:ee,disabled:!ce.value,class:"p-2 text-gray-600 hover:text-gray-800 rounded disabled:opacity-50",title:"Ø¥Ø¹Ø§Ø¯Ø©"},e[13]||(e[13]=[o("i",{class:"fas fa-redo"},null,-1)]),8,At)]),o("div",It,[(p(),v(T,null,R(we,s=>o("button",{key:s.id,onClick:n=>Se(s.id),class:z(["p-2 rounded transition-colors",H.value===s.id?"bg-purple-600 text-white":"text-gray-600 hover:text-gray-800"]),title:s.name},[o("i",{class:z(s.icon)},null,2)],10,Rt)),64))]),o("button",{onClick:ue,disabled:F.value,class:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2 space-x-reverse"},[o("i",{class:z(F.value?"fas fa-spinner fa-spin":"fas fa-save")},null,2),o("span",null,E(F.value?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸"),1)],8,Lt),k.context==="client"&&!k.canSaveAndDownload?(p(),v("button",{key:0,onClick:tt,class:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 flex items-center space-x-2 space-x-reverse",title:"Ø´Ø±Ø§Ø¡ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ­Ù…ÙŠÙ„"},[e[14]||(e[14]=o("i",{class:"fas fa-shopping-cart"},null,-1)),o("span",null,"Ø´Ø±Ø§Ø¡ Ø§Ù„Ù‚Ø§Ù„Ø¨ ("+E(k.templatePrice)+" Ø±ÙŠØ§Ù„)",1)])):k.context!=="client"||k.canSaveAndDownload?(p(),v("button",{key:1,onClick:e[0]||(e[0]=s=>N.value=!0),class:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 flex items-center space-x-2 space-x-reverse",title:"ØªØµØ¯ÙŠØ± Ø§Ù„ØªØµÙ…ÙŠÙ… Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ©"},e[15]||(e[15]=[o("i",{class:"fas fa-download"},null,-1),o("span",null,"ØªØµØ¯ÙŠØ±",-1)]))):$("",!0),o("button",{onClick:Ge,class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 space-x-reverse"},e[16]||(e[16]=[o("i",{class:"fas fa-eye"},null,-1),o("span",null,"Ù…Ø¹Ø§ÙŠÙ†Ø©",-1)])),o("button",{onClick:Fe,class:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 flex items-center space-x-2 space-x-reverse"},e[17]||(e[17]=[o("i",{class:"fas fa-arrow-right"},null,-1),o("span",null,"Ø±Ø¬ÙˆØ¹",-1)]))])])])]),o("div",Ft,[o("div",jt,[o("div",Nt,[o("div",Ut,[(p(),v(T,null,R(xe,s=>o("button",{key:s.id,onClick:n=>P.value=s.id,class:z(["flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-colors",P.value===s.id?"border-purple-600 text-purple-600 bg-purple-50":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"])},[o("i",{class:z([s.icon,"ml-2"])},null,2),pe(" "+E(s.name),1)],10,Bt)),64))])]),o("div",Ot,[P.value==="elements"?(p(),v("div",Vt,[W(mt,{onAddElement:ze,onAddBackground:Oe,onAddImage:Ve})])):$("",!0),P.value==="layers"?(p(),v("div",Wt,[W(bt,{layers:Ee.value,"selected-layer-id":(a=y.value)==null?void 0:a.id,onSelectLayer:Me,onRequestDeleteLayer:nt,onReorderLayers:Ae,onUpdateLayer:t.updateLayer,onDuplicateLayer:t.duplicateLayer,onMoveLayerTop:t.moveLayerToTop,onMoveLayerBottom:t.moveLayerToBottom},null,8,["layers","selected-layer-id","onUpdateLayer","onDuplicateLayer","onMoveLayerTop","onMoveLayerBottom"])])):$("",!0),P.value==="properties"?(p(),v("div",Ht,[o("div",Gt,[e[21]||(e[21]=o("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù„ÙˆØ­Ø©",-1)),o("div",Jt,[e[18]||(e[18]=o("label",{class:"block text-xs font-medium text-gray-600 mb-2"},"Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù„ÙˆØ­Ø©",-1)),o("div",qt,[o("div",null,[K(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>g.value=s),type:"number",min:"100",max:"2000",class:"w-full px-2 py-1 text-xs border border-gray-300 rounded",placeholder:"Ø§Ù„Ø¹Ø±Ø¶"},null,512),[[se,g.value,void 0,{number:!0}]])]),o("div",null,[K(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),type:"number",min:"100",max:"2000",class:"w-full px-2 py-1 text-xs border border-gray-300 rounded",placeholder:"Ø§Ù„Ø§Ø±ØªÙØ§Ø¹"},null,512),[[se,d.value,void 0,{number:!0}]])])])]),x.value?(p(),v("div",Xt,[e[20]||(e[20]=o("label",{class:"block text-xs font-medium text-gray-600 mb-2"},"Ø­Ø¬Ù… ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©",-1)),K(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>C.value=s),class:"w-full px-2 py-1 text-xs border border-gray-300 rounded"},e[19]||(e[19]=[o("option",{value:"contain"},"Ø§Ø­ØªÙˆØ§Ø¡ (Contain)",-1),o("option",{value:"cover"},"ØªØºØ·ÙŠØ© (Cover)",-1),o("option",{value:"100% 100%"},"ØªÙ…Ø¯ÙŠØ¯ (Stretch)",-1)]),512),[[ht,C.value]]),o("div",Kt,[C.value==="contain"?(p(),v("span",Yt,"Ø§Ù„ØµÙˆØ±Ø© ØªØ¸Ù‡Ø± ÙƒØ§Ù…Ù„Ø© Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨Ø©")):C.value==="cover"?(p(),v("span",Qt,"Ø§Ù„ØµÙˆØ±Ø© ØªÙ…Ù„Ø£ Ø§Ù„Ù„ÙˆØ­Ø© Ù…Ø¹ Ù‚Øµ Ø§Ù„Ø²Ø§Ø¦Ø¯")):(p(),v("span",Zt,"Ø§Ù„ØµÙˆØ±Ø© ØªØªÙ…Ø¯Ø¯ Ù„ØªÙ…Ù„Ø£ Ø§Ù„Ù„ÙˆØ­Ø©"))]),o("button",{onClick:We,class:"mt-2 w-full px-2 py-1 text-xs bg-red-100 text-red-600 rounded hover:bg-red-200"}," Ø¥Ø²Ø§Ù„Ø© ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© ")])):$("",!0)]),o("div",ea,[W(xt,{"selected-element":y.value,onUpdateProperties:rt,onMoveLayer:at,onDuplicateElement:st,onRequestDelete:ot},null,8,["selected-element"])])])):$("",!0)])]),o("div",ta,[o("div",aa,[o("div",sa,[o("div",oa,[o("div",na,[o("button",{onClick:De,class:"p-2 text-gray-600 hover:text-gray-800 rounded"},e[22]||(e[22]=[o("i",{class:"fas fa-search-minus"},null,-1)])),o("span",la,E(Math.round(b.value*100))+"%",1),o("button",{onClick:_e,class:"p-2 text-gray-600 hover:text-gray-800 rounded"},e[23]||(e[23]=[o("i",{class:"fas fa-search-plus"},null,-1)]))])])])]),o("div",ia,[o("div",{ref_key:"canvasContainer",ref:be,class:"relative bg-white shadow-lg",style:Y({width:g.value*b.value+"px",height:d.value*b.value+"px",transform:`scale(${b.value})`,transformOrigin:"top left"})},[ve.value?(p(),v("div",{key:0,class:"absolute inset-0 pointer-events-none",style:Y(Ce.value)},null,4)):$("",!0),o("div",{ref_key:"designCanvas",ref:Q,class:"w-full h-full relative overflow-hidden",style:Y({backgroundImage:x.value?`url(${x.value})`:"none",backgroundSize:C.value,backgroundPosition:"center",backgroundRepeat:"no-repeat",cursor:A.value?"crosshair":"default"}),onClick:Ie,onDrop:Re,onDragover:e[4]||(e[4]=oe(()=>{},["prevent"]))},[(p(!0),v(T,null,R(l.value,s=>{var n;return p(),yt(kt,{key:s.id,element:s,selected:((n=y.value)==null?void 0:n.id)===s.id,zoom:b.value,placementMode:!!A.value,onSelect:Pe,onUpdate:Te,onDelete:Z},null,8,["element","selected","zoom","placementMode"])}),128)),L.context==="client"?(p(),v("div",ra,[(p(!0),v(T,null,R(Math.ceil((g.value+d.value)/120)-3,s=>(p(),v("div",{key:s,class:"absolute",style:Y({left:(s+3)*120-d.value/2+"px",top:"50%",fontSize:"16px",color:"rgba(0, 0, 0, 0.15)",fontFamily:"Cairo, sans-serif",fontWeight:"bold",transform:"rotate(-45deg) translateY(-50%)",transformOrigin:"left center",whiteSpace:"nowrap",letterSpacing:"2px"})}," Ø³Ø§Ù…Ù‚Ø© Ù„Ù„ØªØµÙ…ÙŠÙ… ",4))),128))])):$("",!0)],36)],4)])])]),ne.value?(p(),v("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:oe(fe,["self"])},[o("div",ca,[W(wt,{"image-element":le.value,onSave:Be},null,8,["image-element"])])])):$("",!0),ye.value?(p(),v("div",da,[o("div",ua,[e[24]||(e[24]=o("i",{class:"fas fa-spinner fa-spin text-2xl text-purple-600"},null,-1)),o("span",fa,E(me.value),1)])])):$("",!0),j.value?(p(),v("div",pa,[o("div",{class:"bg-white rounded-lg shadow-lg p-8 max-w-sm w-full text-center"},[e[25]||(e[25]=o("h2",{class:"text-lg font-bold mb-4"},"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",-1)),e[26]||(e[26]=o("p",{class:"mb-6"},"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ±ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.",-1)),o("div",{class:"flex justify-center gap-4"},[o("button",{onClick:lt,class:"bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700"},"Ø­Ø°Ù"),o("button",{onClick:it,class:"bg-gray-300 text-gray-700 px-6 py-2 rounded hover:bg-gray-400"},"Ø¥Ù„ØºØ§Ø¡")])])])):$("",!0),N.value?(p(),v("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[8]||(e[8]=s=>N.value=!1)},[o("div",{class:"bg-white rounded-2xl p-6 max-w-lg w-full mx-4",onClick:e[7]||(e[7]=oe(()=>{},["stop"]))},[e[30]||(e[30]=o("h3",{class:"text-xl font-semibold mb-6 text-center"},"ØªØµØ¯ÙŠØ± Ø§Ù„ØªØµÙ…ÙŠÙ…",-1)),o("div",ga,[e[27]||(e[27]=o("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Ø§Ø®ØªØ± Ø­Ø¬Ù… Ø§Ù„ØªØµØ¯ÙŠØ±:",-1)),o("div",ha,[(p(),v(T,null,R($e,s=>o("button",{key:s.value,onClick:n=>ie.value=s.value,class:z(["p-3 border-2 rounded-lg text-center transition-all",ie.value===s.value?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 hover:border-gray-300"])},[o("div",ya,E(s.label),1),o("div",ma,[pe(E(s.width)+" Ã— "+E(s.height)+" ",1),s.dpi?(p(),v("span",ba," ("+E(s.dpi)+" DPI)",1)):$("",!0)])],10,va)),64))])]),o("div",xa,[e[28]||(e[28]=o("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Ø§Ø®ØªØ± ØµÙŠØºØ© Ø§Ù„ØªØµØ¯ÙŠØ±:",-1)),o("div",wa,[(p(),v(T,null,R(ke,s=>o("button",{key:s.value,onClick:n=>U.value=s.value,class:z(["p-4 border-2 rounded-lg text-center transition-all",U.value===s.value?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 hover:border-gray-300"])},[o("i",{class:z([s.icon,"text-2xl mb-2 block"])},null,2),o("div",$a,E(s.label),1),o("div",Ea,E(s.description),1)],10,ka)),64))])]),U.value==="jpeg"?(p(),v("div",Ca,[e[29]||(e[29]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØ±Ø©:",-1)),K(o("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>G.value=s),type:"range",min:"10",max:"100",step:"10",class:"w-full"},null,512),[[se,G.value]]),o("div",Sa,E(G.value)+"%",1)])):$("",!0),o("div",_a,[o("button",{onClick:Ke,disabled:B.value,class:"flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 px-4 rounded-lg font-medium hover:from-purple-600 hover:to-pink-600 transition-all duration-200 disabled:opacity-50"},[B.value?(p(),v("span",za,"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...")):(p(),v("span",Pa,"ØªØµØ¯ÙŠØ±"))],8,Da),o("button",{onClick:e[6]||(e[6]=s=>N.value=!1),class:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200"}," Ø¥Ù„ØºØ§Ø¡ ")])])])):$("",!0)])],64)}}},Ra=$t(Ma,[["__scopeId","data-v-f23ee9a3"]]);export{Ra as default};
