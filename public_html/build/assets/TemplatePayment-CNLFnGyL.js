import{i as v,Z as f,bc as g,c as o,o as n,b as e,t as r,d as y,A as x,a as b,w as h,e as _,r as p,p as w}from"./app-BJSEvLr2.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={name:"TemplatePayment",components:{Head:f,Link:v},props:{template:{type:Object,required:!0},payment:{type:Object,required:!0},templatePurchase:{type:Object,required:!0},moyasarConfig:{type:Object,required:!0}},setup(a){const t=p(!0),s=p(null),i=()=>new Promise((l,d)=>{if(window.Moyasar){l();return}const m=document.createElement("link");m.rel="stylesheet",m.href="https://unpkg.com/moyasar-payment-form@2.0.16/dist/moyasar.css",document.head.appendChild(m);const c=document.createElement("script");c.src="https://unpkg.com/moyasar-payment-form@2.0.16/dist/moyasar.umd.js",c.onload=l,c.onerror=d,document.head.appendChild(c)}),u=async()=>{try{await i(),window.Moyasar.init({element:"#moyasar-form",amount:a.moyasarConfig.amount,currency:a.moyasarConfig.currency,description:a.moyasarConfig.description,publishable_api_key:a.moyasarConfig.publishable_api_key,callback_url:a.moyasarConfig.callback_url,methods:["creditcard"],on_completed:async function(l){try{await fetch(route("client.payment.completed"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({payment_id:l.id,local_payment_id:a.payment.id})})}catch(d){console.error("Error saving payment ID:",d)}}}),t.value=!1}catch(l){console.error("Error loading Moyasar:",l),s.value="فشل في تحميل نموذج الدفع. يرجى إعادة تحميل الصفحة.",t.value=!1}};return w(()=>{u()}),{isLoading:t,error:s}}},j={class:"min-h-screen bg-gray-50 py-8"},M={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},L={class:"text-center mb-8"},z={class:"text-gray-600"},B={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},N={class:"bg-white rounded-lg shadow-md p-6"},O={class:"mb-4"},S=["src","alt"],E={key:1,class:"w-full h-48 bg-gray-200 rounded-lg flex items-center justify-center"},T={class:"space-y-4"},V={class:"flex justify-between items-center"},q={class:"font-medium"},P={key:0,class:"flex justify-between items-center"},H={class:"font-medium"},A={class:"flex justify-between items-center"},D={class:"font-medium"},F={key:1,class:"space-y-2"},I={class:"text-sm text-gray-700 bg-gray-50 p-3 rounded"},J={class:"flex justify-between items-center text-lg font-bold"},K={class:"text-blue-600"},R={class:"bg-white rounded-lg shadow-md p-6"},X={key:0,class:"text-center py-8"},Z={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4 mb-4"},G={class:"flex"},Q={class:"mr-3"},U={class:"mt-1 text-sm text-red-700"},W={key:2},Y={class:"text-center mt-8"};function $(a,t,s,i,u,l){const d=g("Link");return n(),o("div",j,[e("div",M,[e("div",L,[t[0]||(t[0]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," شراء القالب ",-1)),e("p",z," أكمل عملية الدفع لشراء القالب: "+r(s.template.name),1)]),e("div",B,[e("div",N,[t[9]||(t[9]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," تفاصيل القالب ",-1)),e("div",O,[s.template.thumbnail_url?(n(),o("img",{key:0,src:s.template.thumbnail_url,alt:s.template.name,class:"w-full h-48 object-cover rounded-lg border"},null,8,S)):(n(),o("div",E,t[1]||(t[1]=[e("svg",{class:"h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),e("div",T,[e("div",V,[t[2]||(t[2]=e("span",{class:"text-gray-600"},"اسم القالب:",-1)),e("span",q,r(s.template.name),1)]),s.template.category?(n(),o("div",P,[t[3]||(t[3]=e("span",{class:"text-gray-600"},"الفئة:",-1)),e("span",H,r(s.template.category.name),1)])):y("",!0),e("div",A,[t[4]||(t[4]=e("span",{class:"text-gray-600"},"حجم التصميم:",-1)),e("span",D,r(s.template.canvas_size),1)]),s.template.design_notes?(n(),o("div",F,[t[5]||(t[5]=e("span",{class:"text-gray-600"},"ملاحظات التصميم:",-1)),e("p",I,r(s.template.design_notes),1)])):y("",!0),t[7]||(t[7]=e("hr",{class:"my-4"},null,-1)),e("div",J,[t[6]||(t[6]=e("span",null,"السعر:",-1)),e("span",K,r(s.template.price)+" ريال سعودي",1)]),t[8]||(t[8]=x('<div class="bg-blue-50 border border-blue-200 rounded-md p-4" data-v-5ea0ca5c><div class="flex" data-v-5ea0ca5c><div class="flex-shrink-0" data-v-5ea0ca5c><svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor" data-v-5ea0ca5c><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-5ea0ca5c></path></svg></div><div class="mr-3" data-v-5ea0ca5c><h3 class="text-sm font-medium text-blue-800" data-v-5ea0ca5c>ما تحصل عليه</h3><div class="mt-1 text-sm text-blue-700" data-v-5ea0ca5c><ul class="list-disc list-inside space-y-1" data-v-5ea0ca5c><li data-v-5ea0ca5c>إمكانية تحرير القالب بالكامل</li><li data-v-5ea0ca5c>تحميل التصميم بجودة عالية</li><li data-v-5ea0ca5c>استخدام غير محدود للقالب</li><li data-v-5ea0ca5c>إزالة العلامة المائية</li></ul></div></div></div></div>',1))])]),e("div",R,[t[14]||(t[14]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," معلومات الدفع ",-1)),i.isLoading?(n(),o("div",X,t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"جاري تحضير نموذج الدفع...",-1)]))):i.error?(n(),o("div",Z,[e("div",G,[t[12]||(t[12]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Q,[t[11]||(t[11]=e("h3",{class:"text-sm font-medium text-red-800"},"خطأ في تحضير الدفع",-1)),e("p",U,r(i.error),1)])])])):(n(),o("div",W,t[13]||(t[13]=[e("div",{id:"moyasar-form",class:"mb-4"},null,-1),e("div",{class:"text-sm text-gray-500 text-center"},[e("p",null,"الدفع آمن ومحمي بواسطة Moyasar"),e("p",{class:"mt-1"},"نحن لا نحتفظ بمعلومات بطاقتك الائتمانية")],-1)])))])]),e("div",Y,[b(d,{href:a.route("client.templates"),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:h(()=>t[15]||(t[15]=[e("svg",{class:"ml-2 -mr-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),_(" العودة إلى القوالب ")])),_:1,__:[15]},8,["href"])])])])}const se=k(C,[["render",$],["__scopeId","data-v-5ea0ca5c"]]);export{se as default};
