import{r as y,T as H,c as o,o as l,a as _,u as c,Z as L,w as C,b as e,d as f,t as r,i as V,e as m,h as S,j as g,n as k,v as w,F,f as E,x as T,N as q}from"./app-BJSEvLr2.js";import{_ as O}from"./AdminLayoutSidebar-B_xNyK73.js";import"./DropdownLink-BKuK1C9h.js";import"./useTranslations-CytgtFYN.js";const I={class:"p-6",dir:"rtl"},P={class:"flex justify-between items-center mb-6"},A={class:"text-right"},W={class:"text-gray-600 mt-1"},X={class:"flex space-x-3 space-x-reverse"},Z={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},G={class:"flex items-center justify-between"},J={class:"flex items-center"},K={class:"text-sm font-medium text-blue-900"},Q={class:"text-sm text-blue-700"},R={class:"flex space-x-2 space-x-reverse"},Y=["href"],ee={class:"bg-white rounded-lg shadow"},te={class:"px-6 py-4 border-b border-gray-200"},se={class:"text-lg font-semibold text-gray-900 text-right"},oe={class:"text-right"},le={key:0,class:"mt-1 text-sm text-red-600 text-right"},re={key:0,class:"text-right"},ne={class:"flex justify-between items-center mb-4"},ie={class:"block text-sm font-medium text-gray-700 text-right"},de={key:0,class:"text-right"},ae={key:0,class:"mt-1 text-sm text-red-600 text-right"},ue={key:1},ce={key:0,class:"text-center py-8 bg-gray-50 rounded-lg"},me={key:1,class:"space-y-6"},be={class:"flex justify-between items-center mb-4"},xe={class:"text-lg font-medium text-gray-900 text-right"},fe=["onClick"],ve={class:"mb-4 text-right"},ge=["for"],he=["id","onUpdate:modelValue"],pe={key:0,class:"mt-1 text-sm text-red-600 text-right"},ye={class:"text-right"},_e=["for"],ke=["id","onUpdate:modelValue"],we={key:0,class:"mt-1 text-sm text-red-600 text-right"},Ce={key:1,class:"text-right"},je={class:"flex justify-between items-center mb-4"},Ve={class:"block text-sm font-medium text-gray-700 text-right"},Fe={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center"},Be={key:0},Me={class:"mt-4"},$e={key:1,class:"text-center"},Ue={class:"text-sm font-medium text-gray-900"},ze={class:"text-sm text-gray-500"},De={key:0,class:"mt-1 text-sm text-red-600 text-right"},Ne={class:"flex items-center justify-end"},He={class:"flex justify-end space-x-3 space-x-reverse"},Le=["disabled"],Oe={__name:"EditNew",props:{terms:Object},setup(u){const b=u,h=y(!1),v=y(null),n=H({title:b.terms.title,content_blocks:b.terms.content_blocks||[],extracted_content:b.terms.extracted_content||"",file:null,is_active:b.terms.is_active}),x=y(!1),i=y({}),B=s=>{const t=s.target.files[0];t&&(v.value=t,n.file=t)},M=()=>{v.value=null,n.file=null},$=s=>s>=1048576?(s/1048576).toFixed(2)+" ميجابايت":s>=1024?(s/1024).toFixed(2)+" كيلوبايت":s+" بايت",U=s=>({word:"مستند Word",pdf:"مستند PDF"})[s]||s,j=()=>{n.content_blocks.push({subtitle:"",content:""})},z=s=>{n.content_blocks.length>1&&n.content_blocks.splice(s,1)},D=()=>{confirm("هل أنت متأكد من حذف الملف؟ سيتم تحويل المحتوى إلى النمط اليدوي.")&&q.delete(route("admin.terms-of-service.delete-file",b.terms.id))},N=()=>{x.value=!0,h.value&&v.value?n.put(route("admin.terms-of-service.update",b.terms.id),{forceFormData:!0,onSuccess:()=>{x.value=!1},onError:s=>{x.value=!1,i.value=s}}):n.put(route("admin.terms-of-service.update",b.terms.id),{onSuccess:()=>{x.value=!1},onError:s=>{x.value=!1,i.value=s}})};return(s,t)=>(l(),o(F,null,[_(c(L),{title:"تعديل اتفاقية الاستخدام"}),_(O,null,{default:C(()=>[e("div",I,[e("div",P,[e("div",A,[t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-gray-900"},"تعديل اتفاقية الاستخدام",-1)),e("p",W,"تعديل اتفاقية الاستخدام: "+r(u.terms.title),1)]),e("div",X,[_(c(V),{href:s.route("admin.terms-of-service.index"),class:"inline-flex items-center px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:C(()=>t[7]||(t[7]=[e("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),m(" العودة للقائمة ")])),_:1,__:[7]},8,["href"])])]),u.terms.file_name?(l(),o("div",Z,[e("div",G,[e("div",J,[t[8]||(t[8]=e("svg",{class:"h-8 w-8 text-blue-500 ml-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("div",null,[e("p",K,r(u.terms.file_name),1),e("p",Q,r(u.terms.formatted_file_size)+" • "+r(U(u.terms.file_type)),1)])]),e("div",R,[e("a",{href:s.route("admin.terms-of-service.download",u.terms.id),class:"inline-flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"},t[9]||(t[9]=[e("svg",{class:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),m(" تحميل ")]),8,Y),e("button",{onClick:D,class:"inline-flex items-center px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),m(" حذف الملف ")]))])])])):f("",!0),e("div",ee,[e("div",te,[e("h2",se,r(u.terms.file_name?"تعديل محتوى الملف":"تعديل اتفاقية الاستخدام"),1)]),e("form",{onSubmit:S(N,["prevent"]),class:"p-6 space-y-6",enctype:"multipart/form-data"},[e("div",oe,[t[11]||(t[11]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700 mb-2 text-right"},[m(" عنوان الاتفاقية "),e("span",{class:"text-red-500"},"*")],-1)),g(e("input",{id:"title","onUpdate:modelValue":t[0]||(t[0]=d=>c(n).title=d),type:"text",class:k(["w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-right",{"border-red-500":i.value.title}]),placeholder:"مثال: اتفاقية الاستخدام وسياسة الخصوصية",required:"",dir:"rtl"},null,2),[[w,c(n).title]]),i.value.title?(l(),o("div",le,r(i.value.title),1)):f("",!0)]),h.value?(l(),o("div",Ce,[e("div",je,[e("label",Ve,r(u.terms.file_name?"استبدال الملف":"رفع ملف جديد"),1),e("button",{type:"button",onClick:t[3]||(t[3]=d=>h.value=!1),class:"px-3 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm"}," إلغاء ")]),e("div",Fe,[e("input",{ref:"fileInput",type:"file",accept:".pdf,.doc,.docx",onChange:B,class:"hidden"},null,544),v.value?(l(),o("div",$e,[t[19]||(t[19]=e("div",{class:"flex items-center justify-center mb-2"},[e("svg",{class:"h-8 w-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("p",Ue,r(v.value.name),1),e("p",ze,r($(v.value.size)),1),e("button",{type:"button",onClick:M,class:"mt-2 text-sm text-red-600 hover:text-red-700"}," إزالة الملف ")])):(l(),o("div",Be,[t[18]||(t[18]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",Me,[e("button",{type:"button",onClick:t[4]||(t[4]=d=>s.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700"}," اختر ملف "),t[17]||(t[17]=e("p",{class:"mt-2 text-sm text-gray-500"},"PDF, DOC, DOCX حتى 10MB",-1))])]))]),i.value.file?(l(),o("div",De,r(i.value.file),1)):f("",!0)])):(l(),o("div",re,[e("div",ne,[e("label",ie,[m(r(u.terms.file_name?"تعديل المحتوى المستخرج":"محتوى الاتفاقية")+" ",1),t[12]||(t[12]=e("span",{class:"text-red-500"},"*",-1))]),e("button",{type:"button",onClick:t[1]||(t[1]=d=>h.value=!0),class:"px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"},r(u.terms.file_name?"استبدال الملف":"رفع ملف جديد"),1)]),u.terms.file_name?(l(),o("div",de,[g(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=d=>c(n).extracted_content=d),rows:"20",class:k(["w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-right",{"border-red-500":i.value.extracted_content}]),placeholder:"محتوى الملف المستخرج...",dir:"rtl"},null,2),[[w,c(n).extracted_content]]),i.value.extracted_content?(l(),o("div",ae,r(i.value.extracted_content),1)):f("",!0),t[13]||(t[13]=e("p",{class:"mt-2 text-sm text-gray-500 text-right"}," يمكنك تعديل المحتوى المستخرج من الملف مباشرة هنا. التغييرات ستُحفظ دون تأثير على الملف الأصلي. ",-1))])):(l(),o("div",ue,[e("div",{class:"flex justify-between items-center mb-4"},[e("button",{type:"button",onClick:j,class:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"}," + إضافة بند جديد ")]),c(n).content_blocks.length===0?(l(),o("div",ce,[t[14]||(t[14]=e("p",{class:"text-gray-500 mb-4"},"لا توجد بنود بعد",-1)),e("button",{type:"button",onClick:j,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," إضافة أول بند ")])):(l(),o("div",me,[(l(!0),o(F,null,E(c(n).content_blocks,(d,a)=>(l(),o("div",{key:a,class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},[e("div",be,[e("h3",xe," البند رقم "+r(a+1),1),c(n).content_blocks.length>1?(l(),o("button",{key:0,type:"button",onClick:p=>z(a),class:"text-red-600 hover:text-red-800 text-sm"}," حذف البند ",8,fe)):f("",!0)]),e("div",ve,[e("label",{for:"subtitle_"+a,class:"block text-sm font-medium text-gray-700 mb-2 text-right"},t[15]||(t[15]=[m(" عنوان البند "),e("span",{class:"text-red-500"},"*",-1)]),8,ge),g(e("input",{id:"subtitle_"+a,"onUpdate:modelValue":p=>d.subtitle=p,type:"text",class:k(["w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-right",{"border-red-500":i.value[`content_blocks.${a}.subtitle`]}]),placeholder:"مثال: المادة 1: المقدمة",required:"",dir:"rtl"},null,10,he),[[w,d.subtitle]]),i.value[`content_blocks.${a}.subtitle`]?(l(),o("div",pe,r(i.value[`content_blocks.${a}.subtitle`]),1)):f("",!0)]),e("div",ye,[e("label",{for:"content_"+a,class:"block text-sm font-medium text-gray-700 mb-2 text-right"},t[16]||(t[16]=[m(" محتوى البند "),e("span",{class:"text-red-500"},"*",-1)]),8,_e),g(e("textarea",{id:"content_"+a,"onUpdate:modelValue":p=>d.content=p,rows:"6",class:k(["w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-right",{"border-red-500":i.value[`content_blocks.${a}.content`]}]),placeholder:"اكتب محتوى البند هنا...",required:"",dir:"rtl"},null,10,ke),[[w,d.content]]),i.value[`content_blocks.${a}.content`]?(l(),o("div",we,r(i.value[`content_blocks.${a}.content`]),1)):f("",!0)])]))),128))]))]))])),e("div",Ne,[t[20]||(t[20]=e("label",{for:"is_active",class:"ml-2 block text-sm text-gray-900 text-right"}," تفعيل هذه الاتفاقية (سيتم إلغاء تفعيل الاتفاقيات الأخرى) ",-1)),g(e("input",{id:"is_active","onUpdate:modelValue":t[5]||(t[5]=d=>c(n).is_active=d),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[T,c(n).is_active]])]),e("div",He,[_(c(V),{href:s.route("admin.terms-of-service.index"),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"},{default:C(()=>t[21]||(t[21]=[m(" إلغاء ")])),_:1,__:[21]},8,["href"]),e("button",{type:"submit",disabled:x.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},r(x.value?"جاري الحفظ...":"حفظ التغييرات"),9,Le)])],32)])])]),_:1})],64))}};export{Oe as default};
